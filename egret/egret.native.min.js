var __reflect=this&&this.__reflect||function(t,e,r){t.__class__=e,r?r.push(e):r=[e],t.__types__=t.__types__?r.concat(t.__types__):r},__extends=this&&this.__extends||function(t,e){function r(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},egret;!function(t){var e;!function(t){var e=function(){function e(t){this.defaultVertexSrc="attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec2 aColor;\nuniform vec2 projectionVector;\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nconst vec2 center = vec2(-1.0, 1.0);\nvoid main(void) {\n   gl_Position = vec4( (aVertexPosition / projectionVector) + center , 0.0, 1.0);\n   vTextureCoord = aTextureCoord;\n   vColor = vec4(aColor.x, aColor.x, aColor.x, aColor.x);\n}",this.fragmentSrc="",this.gl=null,this.program=null,this.uniforms={projectionVector:{type:"2f",value:{x:0,y:0},dirty:!0}},this.gl=t}return e.prototype.init=function(){var e=this.gl,r=t.WebGLUtils.compileProgram(e,this.defaultVertexSrc,this.fragmentSrc);e.useProgram(r),this.aVertexPosition=e.getAttribLocation(r,"aVertexPosition"),this.aTextureCoord=e.getAttribLocation(r,"aTextureCoord"),this.colorAttribute=e.getAttribLocation(r,"aColor"),-1===this.colorAttribute&&(this.colorAttribute=2),this.attributes=[this.aVertexPosition,this.aTextureCoord,this.colorAttribute];for(var i in this.uniforms)this.uniforms[i].uniformLocation=e.getUniformLocation(r,i);this.initUniforms(),this.program=r},e.prototype.initUniforms=function(){if(this.uniforms){var t,e=this.gl;for(var r in this.uniforms){t=this.uniforms[r],t.dirty=!0;var i=t.type;"mat2"===i||"mat3"===i||"mat4"===i?(t.glMatrix=!0,t.glValueLength=1,"mat2"===i?t.glFunc=e.uniformMatrix2fv:"mat3"===i?t.glFunc=e.uniformMatrix3fv:"mat4"===i&&(t.glFunc=e.uniformMatrix4fv)):(t.glFunc=e["uniform"+i],"2f"===i||"2i"===i?t.glValueLength=2:"3f"===i||"3i"===i?t.glValueLength=3:"4f"===i||"4i"===i?t.glValueLength=4:t.glValueLength=1)}}},e.prototype.syncUniforms=function(){if(this.uniforms){var t,e=this.gl;for(var r in this.uniforms)t=this.uniforms[r],t.dirty&&(1===t.glValueLength?t.glMatrix===!0?t.glFunc.call(e,t.uniformLocation,t.transpose,t.value):t.glFunc.call(e,t.uniformLocation,t.value):2===t.glValueLength?t.glFunc.call(e,t.uniformLocation,t.value.x,t.value.y):3===t.glValueLength?t.glFunc.call(e,t.uniformLocation,t.value.x,t.value.y,t.value.z):4===t.glValueLength&&t.glFunc.call(e,t.uniformLocation,t.value.x,t.value.y,t.value.z,t.value.w),t.dirty=!1)}},e.prototype.setProjection=function(t,e){var r=this.uniforms.projectionVector;(r.value.x!=t||r.value.y!=e)&&(r.value.x=t,r.value.y=e,r.dirty=!0)},e.prototype.setAttribPointer=function(t){var e=this.gl;e.vertexAttribPointer(this.aVertexPosition,2,e.FLOAT,!1,t,0),e.vertexAttribPointer(this.aTextureCoord,2,e.FLOAT,!1,t,8),e.vertexAttribPointer(this.colorAttribute,1,e.FLOAT,!1,t,16)},e}();t.EgretShader=e,__reflect(e.prototype,"egret.native2.EgretShader")}(e=t.native2||(t.native2={}))}(egret||(egret={}));var egret;!function(t){var e;!function(t){var e=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.fragmentSrc="precision lowp float;\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nuniform sampler2D uSampler;\nvoid main(void) {\ngl_FragColor = texture2D(uSampler, vTextureCoord) * vColor;\n}",e}return __extends(e,t),e}(t.EgretShader);t.TextureShader=e,__reflect(e.prototype,"egret.native2.TextureShader")}(e=t.native2||(t.native2={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){function r(t,e,r,i,a){return egret_native.Label.getTextWidth(t,r)}t.sys.measureText=r}(e=t.native2||(t.native2={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){var r=function(r){function i(){var t=r.call(this)||this;return t.init(i.option),t}return __extends(i,r),i.prototype.init=function(r){r.showPaintRect=!1;var i=new t.Stage;i.$screen=this,i.$scaleMode=r.scaleMode,i.$maxTouches=r.maxTouches,i.textureScaleFactor=r.textureScaleFactor,i.frameRate=r.frameRate;var a=new t.sys.RenderBuffer(void 0,void 0,!0),n=a.surface;this.attachCanvas(n);var s=new e.NativeTouchHandler(i),o=new t.sys.Player(a,i,r.entryClassName);if(new e.NativeHideHandler(i),o.showPaintRect(r.showPaintRect),r.showFPS||r.showLog){for(var h=r.fpsStyles||"",u=h.split(","),f={},l=0;l<u.length;l++){var c=u[l].split(":");f[c[0]]=c[1]}r.fpsStyles=f,o.displayFPS(r.showFPS,r.showLog,r.logFilter,r.fpsStyles)}this.playerOption=r,this.$stage=i,this.player=o,this.nativeTouch=s,this.webTouchHandler=s,this.updateScreenSize(),this.updateMaxTouches(),o.start()},i.prototype.updateScreenSize=function(){var e=this.playerOption,r=egret_native.getDeviceWidth(),i=egret_native.getDeviceHeight();t.Capabilities.$boundingClientWidth=r,t.Capabilities.$boundingClientHeight=i;var a=t.sys.screenAdapter.calculateStageSize(this.$stage.$scaleMode,r,i,e.contentWidth,e.contentHeight),n=a.stageWidth,s=a.stageHeight,o=a.displayWidth,h=a.displayHeight,u=(i-h)/2,f=(r-o)/2;egret_native.setVisibleRect(f,u,o,h),egret_native.setDesignSize(n,s);var l=o/n,c=h/s;this.webTouchHandler.updateScaleMode(l,c,0),this.webTouchHandler.updateTouchOffset(n/r,s/i,u,f),this.player.updateStageSize(n,s)},i.prototype.setContentSize=function(t,e){var r=this.playerOption;r.contentWidth=t,r.contentHeight=e,this.updateScreenSize()},i.prototype.attachCanvas=function(t){this.canvas=t,egret_native.setScreenCanvas(t)},i.prototype.updateMaxTouches=function(){this.webTouchHandler.$updateMaxTouches()},i}(t.HashObject);e.NativePlayer=r,__reflect(r.prototype,"egret.native2.NativePlayer",["egret.sys.Screen"])}(e=t.native2||(t.native2={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){var r=function(e){function r(){var t=null!==e&&e.apply(this,arguments)||this;return t._downCount=0,t._path=null,t._bytesTotal=0,t}return __extends(r,e),r.prototype.load=function(t,e){this._downCount=0,this._path=t,this._bytesTotal=e,this.reload()},r.prototype.reload=function(){if(this._downCount>=3)return void this.downloadFileError();this._downCount++;var e=t.PromiseObject.create(),r=this;e.onSuccessFunc=function(){r.loadOver()},e.onErrorFunc=function(){r.reload()},e.downloadingSizeFunc=function(t){r.downloadingProgress(t)},egret_native.download(this._path,this._path,e)},r.prototype.downloadingProgress=function(e){t.ProgressEvent.dispatchProgressEvent(this,t.ProgressEvent.PROGRESS,e,this._bytesTotal)},r.prototype.downloadFileError=function(){this.dispatchEvent(new t.Event(t.IOErrorEvent.IO_ERROR))},r.prototype.loadOver=function(){this.dispatchEvent(new t.Event(t.Event.COMPLETE))},r}(t.EventDispatcher);e.NativeResourceLoader=r,__reflect(r.prototype,"egret.native2.NativeResourceLoader"),t.NativeResourceLoader=r}(e=t.native2||(t.native2={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){function r(e,r){var i=t.sys.canvasHitTestBuffer,a=i.surface;return a}function i(e,i){try{var a=r(this,i),n=a.toDataURL(e);return n}catch(s){return t.$error(1033),null}}function a(e,i,a){try{var n=r(this,a);n.saveToFile(e,i)}catch(s){t.$error(1033)}}function n(e,r){return t.$error(1035),null}t.Texture.prototype.toDataURL=i,t.Texture.prototype.saveToFile=a,t.Texture.prototype.getPixel32=n}(e=t.native2||(t.native2={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){var r=function(e){function r(r){var i=e.call(this)||this;i.scaleX=1,i.scaleY=1,i.rotation=0,i.touchScaleX=1,i.touchScaleY=1,i.touchOffsetX=0,i.touchOffsetY=0,i.$touch=new t.sys.TouchHandler(r);var a=i;return window.addEventListener("touchstart",function(t){for(var e=t.changedTouches.length,r=0;e>r;r++){var i=t.changedTouches[r],n=(i.pageX-a.touchOffsetX)*a.touchScaleX,s=(i.pageY-a.touchOffsetY)*a.touchScaleY;a.$touch.onTouchBegin(n,s,i.identifier)}}),window.addEventListener("touchmove",function(t){for(var e=t.changedTouches.length,r=0;e>r;r++){var i=t.changedTouches[r],n=(i.pageX-a.touchOffsetX)*a.touchScaleX,s=(i.pageY-a.touchOffsetY)*a.touchScaleY;a.$touch.onTouchMove(n,s,i.identifier)}}),window.addEventListener("touchend",function(t){for(var e=t.changedTouches.length,r=0;e>r;r++){var i=t.changedTouches[r],n=(i.pageX-a.touchOffsetX)*a.touchScaleX,s=(i.pageY-a.touchOffsetY)*a.touchScaleY;a.$touch.onTouchEnd(n,s,i.identifier)}}),window.addEventListener("touchcancel",function(t){for(var e=t.changedTouches.length,r=0;e>r;r++){var i=t.changedTouches[r],n=(i.pageX-a.touchOffsetX)*a.touchScaleX,s=(i.pageY-a.touchOffsetY)*a.touchScaleY;a.$touch.onTouchEnd(n,s,i.identifier)}}),i}return __extends(r,e),r.prototype.updateScaleMode=function(t,e,r){this.scaleX=t,this.scaleY=e,this.rotation=r},r.prototype.updateTouchOffset=function(t,e,r,i){this.touchScaleX=t,this.touchScaleY=e,this.touchOffsetX=r,this.touchOffsetY=i},r.prototype.$updateMaxTouches=function(){this.$touch.$initMaxTouches()},r}(t.HashObject);e.NativeTouchHandler=r,__reflect(r.prototype,"egret.native2.NativeTouchHandler")}(e=t.native2||(t.native2={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){function r(t){var e=egret_native.xmlStr2JsonStr(t);e=e.replace(/\n/g,"\\n");var r=JSON.parse(e);return i(r,null)}function i(t,e){if("parsererror"==t.localName)throw new Error(t.textContent);var r=new n(t.localName,e,t.prefix,t.namespace,t.name),a=t.attributes,o=r.attributes;for(var h in a)o[h]=r["$"+h]=a[h];for(var u=t.children,f=u.length,l=r.children,c=0;f>c;c++){var d=u[c],p=d.nodeType,v=null;if(1==p)v=i(d,r);else if(3==p){var y=d.text.trim();y&&(v=new s(y,r))}v&&l.push(v)}return r}var a=function(){function t(t,e){this.nodeType=t,this.parent=e}return t}();e.XMLNode=a,__reflect(a.prototype,"egret.native2.XMLNode");var n=function(t){function e(e,r,i,a,n){var s=t.call(this,1,r)||this;return s.attributes={},s.children=[],s.localName=e,s.prefix=i,s.namespace=a,s.name=n,s}return __extends(e,t),e}(a);e.XML=n,__reflect(n.prototype,"egret.native2.XML");var s=function(t){function e(e,r){var i=t.call(this,3,r)||this;return i.text=e,i}return __extends(e,t),e}(a);e.XMLText=s,__reflect(s.prototype,"egret.native2.XMLText"),t.XML={parse:r}}(e=t.native2||(t.native2={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){var r=function(){function e(){this.onSuccessFunc=null,this.onSuccessThisObject=null,this.onErrorFunc=null,this.onErrorThisObject=null,this.downloadingSizeFunc=null,this.downloadingSizeThisObject=null,this.onResponseHeaderFunc=null,this.onResponseHeaderThisObject=null}return e.create=function(){return e.promiseObjectList.length?e.promiseObjectList.pop():new t.PromiseObject},e.prototype.onSuccess=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.onSuccessFunc&&this.onSuccessFunc.apply(this.onSuccessThisObject,t),this.destroy()},e.prototype.onError=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.onErrorFunc&&this.onErrorFunc.apply(this.onErrorThisObject,t),this.destroy()},e.prototype.downloadingSize=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.downloadingSizeFunc&&this.downloadingSizeFunc.apply(this.downloadingSizeThisObject,t)},e.prototype.onResponseHeader=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.onResponseHeaderFunc&&this.onResponseHeaderFunc.apply(this.onResponseHeaderThisObject,t)},e.prototype.destroy=function(){this.onSuccessFunc=void 0,this.onSuccessThisObject=void 0,this.onErrorFunc=void 0,this.onErrorThisObject=void 0,this.downloadingSizeFunc=void 0,this.downloadingSizeThisObject=void 0,this.onResponseHeaderFunc=void 0,this.onResponseHeaderThisObject=void 0,e.promiseObjectList.push(this)},e}();r.promiseObjectList=[],e.PromiseObject=r,__reflect(r.prototype,"egret.native2.PromiseObject"),t.PromiseObject=r}(e=t.native2||(t.native2={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){function r(e){var r=JSON.parse(e),a=r.functionName,n=i[a];if(n){var s=r.value;n.call(null,s)}else t.$warn(1050,a)}var i={},a=function(){function t(){}return t.call=function(t,e){var r={};r.functionName=t,r.value=e,egret_native.sendInfoToPlugin(JSON.stringify(r))},t.addCallback=function(t,e){i[t]=e},t}();e.NativeExternalInterface=a,__reflect(a.prototype,"egret.native2.NativeExternalInterface",["egret.ExternalInterface"]),t.ExternalInterface=a,egret_native.receivedPluginInfo=r}(e=t.native2||(t.native2={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){var r;!function(r){function i(t){return u[t]}function a(e,r){r=void 0===r?"undefined":null===r?"null":r.toString(),u[e]=r;try{return o(),!0}catch(i){return t.$warn(1018,e,r),!1}}function n(t){delete u[t],o()}function s(){for(var t in u)delete u[t];o()}function o(){}var h="LocalStorage.local",u={};if(egret_native.isRecordExists(h)){var f=egret_native.loadRecord(h);try{u=JSON.parse(f)}catch(l){u={}}}else u={};e.getItem=i,e.setItem=a,e.removeItem=n,e.clear=s}(r=e.native2||(e.native2={}))}(e=t.localStorage||(t.localStorage={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){var r=function(r){function i(){var t=r.call(this)||this;return t.loaded=!1,t}return __extends(i,r),Object.defineProperty(i.prototype,"length",{get:function(){throw new Error("sound length not supported")},enumerable:!0,configurable:!0}),i.prototype.load=function(r){function i(){var i=e.PromiseObject.create();i.onSuccessFunc=a,i.onErrorFunc=function(){t.IOErrorEvent.dispatchIOErrorEvent(n)},egret_native.download(r,r,i)}function a(){n.loaded=!0,n.preload()}var n=this;this.url=r,egret_native.fs.isFileExistSync(r)?__global.setTimeout?__global.setTimeout(a,0):t.$callAsync(a,n):i()},i.prototype.preload=function(){var e=this;if(e.type==t.Sound.EFFECT){var r=new t.PromiseObject;r.onSuccessFunc=function(r){e.dispatchEventWith(t.Event.COMPLETE)},egret_native.Audio.preloadEffectAsync(e.url,r)}else e.dispatchEventWith(t.Event.COMPLETE)},i.prototype.play=function(r,i){r=+r||0,i=+i||0;var a=new e.NaSoundChannel;return a.$url=this.url,a.$loops=i,a.$type=this.type,a.$startTime=r,a.$play(),t.sys.$pushSoundChannel(a),a},i.prototype.close=function(){},i}(t.EventDispatcher);r.MUSIC="music",r.EFFECT="effect",e.NaSound=r,__reflect(r.prototype,"egret.native2.NaSound",["egret.Sound"]),__global.Audio||(t.Sound=r)}(e=t.native2||(t.native2={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){var r=function(e){function r(){var t=e.call(this)||this;return t.$startTime=0,t.isStopped=!1,t._startTime=0,t}return __extends(r,e),r.prototype.$play=function(){this.isStopped=!1,this.$type==t.Sound.EFFECT?this._effectId=egret_native.Audio.playEffect(this.$url,1!=this.$loops):(r.currentPath=this.$url,egret_native.Audio.playBackgroundMusic(this.$url,1!=this.$loops)),this._startTime=Date.now()},r.prototype.stop=function(){this.isStopped||t.sys.$popSoundChannel(this),this.isStopped=!0,this.$type==t.Sound.EFFECT?this._effectId&&(egret_native.Audio.stopEffect(this._effectId),this._effectId=null):this.$url==r.currentPath&&egret_native.Audio.stopBackgroundMusic(!1)},Object.defineProperty(r.prototype,"volume",{get:function(){return this.$type==t.Sound.EFFECT?egret_native.Audio.getEffectsVolume():egret_native.Audio.getBackgroundMusicVolume()},set:function(e){this.$type==t.Sound.EFFECT?egret_native.Audio.setEffectsVolume(e):egret_native.Audio.setBackgroundMusicVolume(e)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"position",{get:function(){return(Date.now()-this._startTime)/1e3},enumerable:!0,configurable:!0}),r}(t.EventDispatcher);e.NaSoundChannel=r,__reflect(r.prototype,"egret.native2.NaSoundChannel",["egret.SoundChannel","egret.IEventDispatcher"])}(e=t.native2||(t.native2={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){var r=function(r){function i(){var t=r.call(this)||this;return t.loaded=!1,t}return __extends(i,r),Object.defineProperty(i.prototype,"length",{get:function(){if(this.originAudio)return this.originAudio.duration;throw new Error("sound not loaded!")},enumerable:!0,configurable:!0}),i.prototype.load=function(r){function a(){var t=e.PromiseObject.create();t.onSuccessFunc=n,t.onErrorFunc=o,egret_native.download(r,r,t)}function n(){f.load(),i.$recycle(r,f)}function s(){h(),u.loaded=!0,u.dispatchEventWith(t.Event.COMPLETE)}function o(){h(),u.dispatchEventWith(t.IOErrorEvent.IO_ERROR)}function h(){f.removeEventListener("canplaythrough",s),f.removeEventListener("error",o)}var u=this;this.url=r;var f=new Audio(r);f.addEventListener("canplaythrough",s),f.addEventListener("error",o),this.originAudio=f,egret_native.fs.isFileExistSync(r)?n():a()},i.prototype.play=function(r,a){r=+r||0,a=+a||0;var n=i.$pop(this.url);null==n?n=new Audio(this.url):n.load();var s=new e.NativeSoundChannel(n);return s.$url=this.url,s.$loops=a,s.$startTime=r,s.$play(),t.sys.$pushSoundChannel(s),s},i.prototype.close=function(){0==this.loaded&&this.originAudio&&(this.originAudio.src=""),this.originAudio&&(this.originAudio=null),i.$clear(this.url)},i.$clear=function(t){var e=i.audios[t];e&&(e.length=0)},i.$pop=function(t){var e=i.audios[t];return e&&e.length>0?e.pop():null},i.$recycle=function(t,e){var r=i.audios[t];null==i.audios[t]&&(r=i.audios[t]=[]),r.push(e)},i}(t.EventDispatcher);r.MUSIC="music",r.EFFECT="effect",r.audios={},e.NativeSound=r,__reflect(r.prototype,"egret.native2.NativeSound",["egret.Sound"]),__global.Audio&&(t.Sound=r)}(e=t.native2||(t.native2={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){var r=function(r){function i(e){var i=r.call(this)||this;return i.$startTime=0,i.audio=null,i.isStopped=!1,i.onPlayEnd=function(){return 1==i.$loops?(i.stop(),void i.dispatchEventWith(t.Event.SOUND_COMPLETE)):(i.$loops>0&&i.$loops--,void i.$play())},i.$volume=1,e.addEventListener("ended",i.onPlayEnd),i.audio=e,i}return __extends(i,r),i.prototype.$play=function(){if(this.isStopped)return void t.$error(1036);try{this.audio.currentTime=this.$startTime}catch(e){}finally{this.audio.volume=this.$volume,this.audio.play()}},i.prototype.stop=function(){if(this.audio){this.isStopped||t.sys.$popSoundChannel(this),this.isStopped=!0;var r=this.audio;r.pause(),r.removeEventListener("ended",this.onPlayEnd),this.audio=null,e.NativeSound.$recycle(this.$url,r)}},Object.defineProperty(i.prototype,"volume",{get:function(){return 1},set:function(t){},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"position",{get:function(){return 0},enumerable:!0,configurable:!0}),i}(t.EventDispatcher);e.NativeSoundChannel=r,__reflect(r.prototype,"egret.native2.NativeSoundChannel",["egret.SoundChannel","egret.IEventDispatcher"])}(e=t.native2||(t.native2={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){var r=function(r){function i(e,i){void 0===i&&(i=!0);var a=r.call(this)||this;return a.loaded=!1,a.loading=!1,a.loop=!1,a.isPlayed=!1,a.firstPlay=!0,a.src="",a._fullscreen=!0,a._bitmapData=null,a.paused=!1,a.isAddToStage=!1,a.heightSet=0,a.widthSet=0,a.$renderNode=new t.sys.BitmapNode,a.cache=i,__global.Video||t.$error(1044),e&&a.load(e,i),a}return __extends(i,r),i.prototype.load=function(e,r){if(void 0===r&&(r=!0),!this.loading)if(0==e.indexOf("/")&&(e=e.slice(1,e.length)),this.src=e,this.loading=!0,this.loaded=!1,r&&!egret_native.fs.isFileExistSync(e)){var i=this,a=t.PromiseObject.create();a.onSuccessFunc=function(){i.loadEnd()},a.onErrorFunc=function(){t.$warn(1048),i.dispatchEventWith(t.IOErrorEvent.IO_ERROR)},egret_native.download(e,e,a)}else this.loadEnd()},i.prototype.loadEnd=function(){function e(){n.setVideoRect(0,0,1,1),n.play()}function r(){n.setVideoRect(0,0,1,1),__global.setTimeout(function(){n.pause(),s._fullscreen&&(n.fullScreen=!0),n.currentTime=0,s.originVideo=n,s.loaded=!0,s.loading=!1,a(),s.dispatchEventWith(t.Event.COMPLETE),n.addEventListener("pause",function(){s.paused=!0}),n.addEventListener("playing",function(){s.paused=!1}),n.addEventListener("ended",function(){s.dispatchEventWith(t.Event.ENDED),s.loop&&s.play(0,!0)})},1)}function i(){a(),s.dispatchEventWith(t.IOErrorEvent.IO_ERROR)}function a(){n.removeEventListener("canplaythrough",e),n.removeEventListener("error",i),n.removeEventListener("playing",r)}var n=new __global.Video(this.src);n.setVideoRect(0,0,1,1),n.setKeepRatio(!1),n.addEventListener("canplaythrough",e),n.addEventListener("error",i),n.addEventListener("playing",r),n.load();var s=this},i.prototype.play=function(e,r){var i=this;if(void 0===r&&(r=!1),this.loop=r,!this.loaded)return this.load(this.src),void this.once(t.Event.COMPLETE,function(t){return i.play(e,r)},this);var a=!1;void 0!=e&&e!=this.originVideo.currentTime&&(this.originVideo.currentTime=e||0,a=!0),this.startPlay(a)},i.prototype.startPlay=function(e){void 0===e&&(e=!1),this.isAddToStage&&this.loaded&&(this.firstPlay=!1,this.setVideoSize(),this.isPlayed=!0,!e&&this.paused&&0!=this.position?this.originVideo.resume():this.originVideo.play(),t.startTick(this.markDirty,this))},i.prototype.stopPlay=function(){t.stopTick(this.markDirty,this),this.isPlayed&&(this.isPlayed=!1,this.originVideo.pause())},i.prototype.close=function(){this.originVideo&&this.originVideo.destroy(),this.loaded=!1,this.loading=!1,this.originVideo=null,this.loop=!1,this.src=null},Object.defineProperty(i.prototype,"poster",{get:function(){return this.posterUrl},set:function(r){var i=this;this.posterUrl=r;var a=new e.NativeImageLoader;a.load(r),a.addEventListener(t.Event.COMPLETE,function(){i.posterData=a.data,i.markDirty(),i.$invalidateContentBounds()},this)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"fullscreen",{get:function(){return this.originVideo?this.originVideo.fullScreen:this._fullscreen},set:function(t){this._fullscreen=t,this.originVideo&&(this.originVideo.fullScreen=t)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"volume",{get:function(){return this.loaded?this.originVideo.volume:0},set:function(t){this.loaded&&(this.originVideo.volume=t)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"position",{get:function(){return this.originVideo.currentTime},set:function(t){this.loaded&&(this.originVideo.currentTime=t)},enumerable:!0,configurable:!0}),i.prototype.pause=function(){this.originVideo.pause()},Object.defineProperty(i.prototype,"bitmapData",{get:function(){return this._bitmapData},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"length",{get:function(){if(this.loaded)return this.originVideo.duration;throw new Error("Video not loaded!")},enumerable:!0,configurable:!0}),i.prototype.$onAddToStage=function(t,e){this.isAddToStage=!0,this.originVideo&&this.originVideo.setVideoVisible(!0),this.$invalidate(),this.$invalidateContentBounds(),r.prototype.$onAddToStage.call(this,t,e)},i.prototype.$onRemoveFromStage=function(){this.isAddToStage=!1,this.originVideo&&(this.stopPlay(),this.originVideo.setVideoVisible(!1)),r.prototype.$onRemoveFromStage.call(this)},i.prototype.getPlayWidth=function(){return isNaN(this.widthSet)?this.bitmapData?this.bitmapData.width:this.posterData?this.posterData.width:0/0:this.widthSet},i.prototype.getPlayHeight=function(){return isNaN(this.heightSet)?this.bitmapData?this.bitmapData.height:this.posterData?this.posterData.height:0/0:this.heightSet},i.prototype.$setHeight=function(t){return this.heightSet=+t||0,this.setVideoSize(),this.$invalidate(),this.$invalidateContentBounds(),r.prototype.$setHeight.call(this,t)},i.prototype.$setWidth=function(t){return this.widthSet=+t||0,this.setVideoSize(),this.$invalidate(),this.$invalidateContentBounds(),r.prototype.$setWidth.call(this,t)},i.prototype.$setX=function(t){var e=r.prototype.$setX.call(this,t);return this.setVideoSize(),e},i.prototype.$setY=function(t){var e=r.prototype.$setY.call(this,t);return this.setVideoSize(),e},i.prototype.setVideoSize=function(){var t=this.originVideo;t&&!this.fullscreen&&(this.firstPlay?t.setVideoRect(this.x,this.y,0,0):t.setVideoRect(this.x,this.y,this.widthSet,this.heightSet))},i.prototype.$measureContentBounds=function(t){var e=this.posterData;e?t.setTo(0,0,this.getPlayWidth(),this.getPlayHeight()):t.setEmpty()},i.prototype.$render=function(){var t=this.$renderNode,e=this.posterData,r=this.getPlayWidth(),i=this.getPlayHeight();0>=r||0>=i||(!this.isPlayed&&e?(t.image=e,t.drawImage(0,0,e.width,e.height,0,0,r,i)):this.isPlayed&&this.setVideoSize())},i.prototype.markDirty=function(){return this.$invalidate(),!0},i}(t.DisplayObject);e.NativeVideo=r,__reflect(r.prototype,"egret.native2.NativeVideo",["egret.Video","egret.DisplayObject"])}(e=t.native2||(t.native2={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){var r=function(r){function i(){var t=r.call(this)||this;return t._url="",t._method="",t.urlData={},t.responseHeader="",t}return __extends(i,r),Object.defineProperty(i.prototype,"response",{get:function(){return this._response},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"responseType",{get:function(){return this._responseType},set:function(t){this._responseType=t},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"withCredentials",{get:function(){return this._withCredentials},set:function(t){this._withCredentials=t},enumerable:!0,configurable:!0}),i.prototype.open=function(t,e){void 0===e&&(e="GET"),this._url=t,this._method=e},i.prototype.send=function(r){function i(){var r=new t.PromiseObject;r.onSuccessFunc=function(e){n._response=e,t.Event.dispatchEvent(n,t.Event.COMPLETE)},r.onErrorFunc=function(){t.Event.dispatchEvent(n,t.IOErrorEvent.IO_ERROR)},n._responseType==t.HttpResponseType.ARRAY_BUFFER?e.FileManager.readFileAsync(n._url,r,"ArrayBuffer"):e.FileManager.readFileAsync(n._url,r,"String")}function a(){var r=e.PromiseObject.create();r.onSuccessFunc=i,r.onErrorFunc=function(){t.Event.dispatchEvent(n,t.IOErrorEvent.IO_ERROR)},r.onResponseHeaderFunc=this.onResponseHeader,r.onResponseHeaderThisObject=this,egret_native.download(n._url,n._url,r)}var n=this;if(n.isNetUrl(n._url)){n.urlData.type=n._method,n._method==t.HttpMethod.POST&&r?r instanceof ArrayBuffer?n.urlData.data=r:n.urlData.data=r.toString():delete n.urlData.data,n._responseType==t.HttpResponseType.ARRAY_BUFFER?n.urlData.binary=!0:n.urlData.binary=!1,this.headerObj?n.urlData.header=JSON.stringify(this.headerObj):delete n.urlData.header;var s=t.PromiseObject.create();s.onSuccessFunc=function(e){n._response=e,t.$callAsync(t.Event.dispatchEvent,t.Event,n,t.Event.COMPLETE)},s.onErrorFunc=function(e){t.$warn(1019,e),t.Event.dispatchEvent(n,t.IOErrorEvent.IO_ERROR)},s.onResponseHeaderFunc=this.onResponseHeader,s.onResponseHeaderThisObject=this,egret_native.requestHttp(n._url,n.urlData.type,n.urlData.header?n.urlData.header:"",n.urlData.data?n.urlData.data:"",n.urlData.binary,s)}else e.FileManager.isFileExistSync(n._url)?i():a()},i.prototype.isNetUrl=function(t){return-1!=t.indexOf("http://")||-1!=t.indexOf("HTTP://")||-1!=t.indexOf("https://")||-1!=t.indexOf("HTTPS://")},i.prototype.abort=function(){},i.prototype.onResponseHeader=function(t){this.responseHeader="";var e=JSON.parse(t);for(var r in e)this.responseHeader+=r+": "+e[r]+"\r\n"},i.prototype.getAllResponseHeaders=function(){return this.responseHeader},i.prototype.setRequestHeader=function(t,e){this.headerObj||(this.headerObj={}),this.headerObj[t]=e},i.prototype.getResponseHeader=function(t){return""},i}(t.EventDispatcher);e.NativeHttpRequest=r,__reflect(r.prototype,"egret.native2.NativeHttpRequest",["egret.HttpRequest"]),t.HttpRequest=r}(e=t.native2||(t.native2={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){var r=function(r){function i(){var t=null!==r&&r.apply(this,arguments)||this;return t.data=null,t._crossOrigin=null,t}return __extends(i,r),Object.defineProperty(i.prototype,"crossOrigin",{get:function(){return this._crossOrigin},set:function(t){this._crossOrigin=t},enumerable:!0,configurable:!0}),i.prototype.load=function(t){this.check(t)},i.prototype.check=function(t){var r=this;r.isNetUrl(t)?r.download(t):egret_native.fs.isFileExistSync(e.FileManager.makeFullPath(t))?r.loadTexture(t):r.download(t)},i.prototype.download=function(e){var r=this,i=t.PromiseObject.create();i.onSuccessFunc=function(){r.loadTexture(e)},i.onErrorFunc=function(){r.dispatchEventWith(t.IOErrorEvent.IO_ERROR)},egret_native.download(e,e,i)},i.prototype.loadTexture=function(r){var i=this,a=new t.PromiseObject;a.onSuccessFunc=function(e){i.data=new t.BitmapData(e),i.dispatchEventWith(t.Event.COMPLETE)},a.onErrorFunc=function(){i.dispatchEventWith(t.IOErrorEvent.IO_ERROR)},egret_native.createImage(e.FileManager.makeFullPath(r),a)},i.prototype.isNetUrl=function(t){return-1!=t.indexOf("http://")||-1!=t.indexOf("HTTP://")||-1!=t.indexOf("https://")||-1!=t.indexOf("HTTPS://")},i}(t.EventDispatcher);r.crossOrigin=null,e.NativeImageLoader=r,__reflect(r.prototype,"egret.native2.NativeImageLoader",["egret.ImageLoader"]),t.ImageLoader=r}(e=t.native2||(t.native2={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){var r=function(e){function r(){var t=e.call(this)||this;return t.textValue="",t.colorValue=16777215,t.isFinishDown=!1,t.textValue="",t}return __extends(r,e),r.prototype.$getText=function(){return this.textValue||(this.textValue=""),this.textValue},r.prototype.$setText=function(t){return this.textValue=t,!0},r.prototype.$setColor=function(t){return this.colorValue=t,!0},r.prototype.$onBlur=function(){},r.prototype.showScreenKeyboard=function(){var e=this;e.dispatchEvent(new t.Event("focus")),t.Event.dispatchEvent(e,"focus",!1,{showing:!0}),egret_native.EGT_TextInput=function(r){e.$textfield.multiline?(e.textValue=r,e.dispatchEvent(new t.Event("updateText")),e.isFinishDown&&(e.isFinishDown=!1,e.dispatchEvent(new t.Event("blur")))):(e.textValue=r.replace(/[\n|\r]/,""),egret_native.TextInputOp.setKeybordOpen(!1),e.dispatchEvent(new t.Event("updateText")),e.dispatchEvent(new t.Event("blur")))},egret_native.EGT_keyboardFinish=function(){e.$textfield.multiline&&(e.isFinishDown=!0)}},r.prototype.$show=function(){var e=this,r=this.$textfield,i=r.$TextField;egret_native.TextInputOp.setKeybordOpen(!1),egret_native.EGT_getTextEditerContentText=function(){return e.$getText()},egret_native.EGT_keyboardDidShow=function(){e.showScreenKeyboard(),egret_native.EGT_keyboardDidShow=function(){},egret_native.TextInputOp.updateConfig&&egret_native.TextInputOp.updateConfig(JSON.stringify({font_color:i[2]}))},egret_native.EGT_keyboardDidHide=function(){},egret_native.EGT_deleteBackward=function(){};var a=i[37],n=i[30]?0:6,s=-1;a==t.TextFieldInputType.PASSWORD?s=0:a==t.TextFieldInputType.TEL&&(n=3);var o=1,h=i[21]<=0?-1:i[21],u=(r.$getRenderNode(),this.$textfield.localToGlobal(0,0));egret_native.TextInputOp.setKeybordOpen(!0,JSON.stringify({inputMode:n,inputFlag:s,returnType:o,maxLength:h,x:u.x,y:u.y,width:r.width,height:r.height,font_size:i[0],font_color:i[2],textAlign:i[9],verticalAlign:i[10]}))},r.prototype.$hide=function(){egret_native.TextInputOp.setKeybordOpen(!1),this.dispatchEvent(new t.Event("blur"))},r.prototype.$resetStageText=function(){},r.prototype.$addToStage=function(){},r.prototype.$removeFromStage=function(){},r.prototype.$setTextField=function(t){return this.$textfield=t,!0},r}(t.EventDispatcher);e.NativeStageText=r,__reflect(r.prototype,"egret.native2.NativeStageText",["egret.StageText"]),t.StageText=r}(e=t.native2||(t.native2={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){var r=function(e){function r(r,i,a,n,s){var o=e.call(this)||this;return o.arrFps=[],o.arrLog=[],(i||a)&&(o.panelX=void 0===s.x?0:parseInt(s.x),o.panelY=void 0===s.y?0:parseInt(s.y),o._stage=r,o.showFps=i,o.showLog=a,o.fontColor=void 0===s.textColor?16777215:parseInt(s.textColor),o.fontSize=void 0===s.size?24:parseInt(s.size),o.bgAlpha=s.bgAlpha||.9,o.shape=new t.Shape,o.addChild(o.shape),i&&o.addFps(),a&&o.addLog()),o}return __extends(r,e),r.prototype.addFps=function(){var e=new t.TextField;e.x=e.y=4,this.textFps=e,this.addChild(e),e.lineSpacing=2,e.size=this.fontSize,e.textColor=this.fontColor,e.textFlow=[{text:"0 FPS "+t.Capabilities.renderMode+"\n"},{text:"Draw: 0\nDirty: 0%\n"},{text:"Cost: "},{text:"0 ",style:{textColor:1638142}},{text:"0 ",style:{textColor:16776960}},{text:"0 ",style:{textColor:16711680}}]
},r.prototype.addLog=function(){var e=new t.TextField;e.size=this.fontSize,e.textColor=this.fontColor,e.x=4,this.addChild(e),this.textLog=e},r.prototype.update=function(e){this.arrFps.push(e.fps);var r=0,i=this.arrFps.length;i>101&&(i=101,this.arrFps.shift());for(var a=this.arrFps[0],n=this.arrFps[0],s=0;i>s;s++){var o=this.arrFps[s];r+=o,a>o?a=o:o>n&&(n=o)}this.textFps.textFlow=[{text:e.fps+" FPS "+t.Capabilities.renderMode+"\n"},{text:"min"+a+" max"+n+" avg"+Math.floor(r/i)+"\n"},{text:"Draw: "+e.draw+"\nDirty: "+e.dirty+"%\n"},{text:"Cost: "},{text:e.costTicker+" ",style:{textColor:1638142}},{text:e.costDirty+" ",style:{textColor:16776960}},{text:e.costRender+" ",style:{textColor:16711680}}],this.updateLayout()},r.prototype.updateInfo=function(t){var e=0;if(this.showFps&&(e=this.textFps.height,this.textLog.y=e+4),this.arrLog.push(t),this.textLog.text=this.arrLog.join("\n"),this._stage.stageHeight>0)for(this.textLog.textWidth>this._stage.stageWidth-20-this.panelX&&(this.textLog.width=this._stage.stageWidth-20-this.panelX);this.textLog.textHeight>this._stage.stageHeight-e-20-this.panelY;)this.arrLog.shift(),this.textLog.text=this.arrLog.join("\n");this.updateLayout()},r.prototype.updateLayout=function(){if(t.Capabilities.runtimeType!=t.RuntimeType.NATIVE){var e=this.shape.$graphics;e.clear(),e.beginFill(0,this.bgAlpha),e.drawRect(0,0,this.width+8,this.height+8),e.endFill()}},r}(t.Sprite);e.NativeFps=r,__reflect(r.prototype,"egret.native2.NativeFps",["egret.FPSDisplay","egret.DisplayObject"]),t.FPSDisplay=r}(e=t.native2||(t.native2={}))}(egret||(egret={}));var egret;!function(t){var e;!function(t){}(e=t.native2||(t.native2={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){function r(t){t.onStart(h),o=t}function i(r){if(!u){u=!0,r||(r={}),e.WebGLRenderContext.$supportCmdBatch=e.$glCmdBatch,a(r.renderMode);try{t.Capabilities.$setNativeCapabilities(egret_native.getVersion())}catch(i){}var n=t.sys.$ticker,s=function(){o&&o.onRender(h),n.update()};egret_native.setOnUpdate(s,n),t.sys.screenAdapter||(r.screenAdapter?t.sys.screenAdapter=r.screenAdapter:t.sys.screenAdapter=new t.sys.DefaultScreenAdapter);var l=new e.NativePlayer;f.push(l),l.$stage.dirtyRegionPolicy=t.DirtyRegionPolicy.OFF,t.sys.DisplayList.prototype.setDirtyRegionPolicy=function(){}}}function a(r){t.sys.CanvasRenderBuffer=e.WebGLRenderBuffer,t.sys.RenderBuffer=e.WebGLRenderBuffer,t.sys.systemRenderer=new e.WebGLRenderer,t.sys.canvasRenderer=new e.WebGLRenderer,t.sys.customHitTestBuffer=new e.WebGLRenderBuffer(3,3),t.sys.canvasHitTestBuffer=new e.WebGLRenderBuffer(3,3),t.Capabilities.$renderMode="webgl"}function n(){for(var t=f.length,e=0;t>e;e++)f[e].updateScreenSize()}function s(t){for(var e=[],r=0;r<t.length;r++)e.push(t[r]);return e}var o,h={setAutoClear:function(t){e.WebGLRenderBuffer.autoClear=t},save:function(){},restore:function(){var t=e.WebGLRenderContext.getInstance(0,0),r=t.context;e.WebGLRenderContext.$supportCmdBatch&&(r=t.glCmdManager),r.bindBuffer(r.ARRAY_BUFFER,t.vertexBuffer),r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,t.indexBuffer),r.activeTexture(r.TEXTURE0),t.shaderManager.currentShader=null,t.bindIndices=!1;var i=t.$bufferStack[1];t.activateBuffer(i),r.enable(r.BLEND),t.setBlendMode("source-over")}};t.setRendererContext=r,e.$supportCanvas=egret_native.Canvas?!0:!1,e.$glCmdBatch=!1;var u=!1,f=[];t.warn=function(){console.warn.apply(console,s(arguments))},t.error=function(){console.error.apply(console,s(arguments))},t.assert=function(){console.assert.apply(console,s(arguments))},t.log=function(){console.log.apply(console,s(arguments))},t.runEgret=i,t.updateAllScreens=n}(e=t.native2||(t.native2={}))}(egret||(egret={})),function(t){var e;!function(e){e.$supportCanvas=!0,t["native"].$supportCanvas=t.native2.$supportCanvas}(e=t["native"]||(t["native"]={}))}(egret||(egret={})),function(t){var e;!function(e){e.$supportGLCmdBatch=!1,t["native"].$supportGLCmdBatch=t.native2.$glCmdBatch}(e=t["native"]||(t["native"]={}))}(egret||(egret={}));var egret;!function(t){var e;!function(t){function e(t,e){var r=document.createElement("canvas");isNaN(t)||isNaN(e)||(r.width=t,r.height=e);var i=r.getContext("2d");if(void 0===i.imageSmoothingEnabled){for(var a,n=["webkitImageSmoothingEnabled","mozImageSmoothingEnabled","msImageSmoothingEnabled"],s=n.length-1;s>=0&&(a=n[s],void 0===i[a]);s--);try{Object.defineProperty(i,"imageSmoothingEnabled",{get:function(){return this[a]},set:function(t){this[a]=t}})}catch(o){i.imageSmoothingEnabled=i[a]}}return r}var r,i=function(){function t(t,e,r){}return Object.defineProperty(t.prototype,"width",{get:function(){return this.surface.width},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this.surface.height},enumerable:!0,configurable:!0}),t.prototype.resize=function(t,e,r){var i=this.surface;if(r){var a=!1;i.width<t&&(i.width=t,a=!0),i.height<e&&(i.height=e,a=!0),a||(this.context.globalCompositeOperation="source-over",this.context.setTransform(1,0,0,1,0,0),this.context.globalAlpha=1)}else i.width!=t&&(i.width=t),i.height!=e&&(i.height=e);this.clear()},t.prototype.resizeTo=function(t,i,a,n){r||(r=e());var s=(this.context,this.surface),o=r,h=o.getContext("2d");r=s,this.context=h,this.surface=o,o.width=Math.max(t,257),o.height=Math.max(i,257),h.setTransform(1,0,0,1,0,0),h.drawImage(s,a,n),s.height=1,s.width=1},t.prototype.setDirtyRegionPolicy=function(t){},t.prototype.beginClip=function(t,e,r){e=+e||0,r=+r||0;var i=this.context;i.save(),i.beginPath(),i.setTransform(1,0,0,1,e,r);for(var a=t.length,n=0;a>n;n++){var s=t[n];i.clearRect(s.minX,s.minY,s.width,s.height),i.rect(s.minX,s.minY,s.width,s.height)}i.clip()},t.prototype.endClip=function(){this.context.restore()},t.prototype.getPixels=function(t,e,r,i){return void 0===r&&(r=1),void 0===i&&(i=1),this.context.getImageData(t,e,r,i).data},t.prototype.toDataURL=function(t,e){return this.surface.toDataURL(t,e)},t.prototype.clear=function(){this.context.setTransform(1,0,0,1,0,0),this.context.clearRect(0,0,this.surface.width,this.surface.height)},t.prototype.destroy=function(){this.surface.width=this.surface.height=0},t}();t.CanvasRenderBuffer=i,__reflect(i.prototype,"egret.native2.CanvasRenderBuffer",["egret.sys.RenderBuffer"])}(e=t.native2||(t.native2={}))}(egret||(egret={}));var egret;!function(t){var e;!function(t){var e=function(){function t(){this.drawData=[],this.drawDataLen=0}return t.prototype.pushDrawRect=function(){if(0==this.drawDataLen||1!=this.drawData[this.drawDataLen-1].type){var t=this.drawData[this.drawDataLen]||{};t.type=1,t.count=0,this.drawData[this.drawDataLen]=t,this.drawDataLen++}this.drawData[this.drawDataLen-1].count+=2},t.prototype.pushDrawTexture=function(t,e,r,i,a){if(void 0===e&&(e=2),r){var n=this.drawData[this.drawDataLen]||{};n.type=0,n.texture=t,n.filter=r,n.count=e,n.textureWidth=i,n.textureHeight=a,this.drawData[this.drawDataLen]=n,this.drawDataLen++}else{if(0==this.drawDataLen||0!=this.drawData[this.drawDataLen-1].type||t!=this.drawData[this.drawDataLen-1].texture||this.drawData[this.drawDataLen-1].filter){var n=this.drawData[this.drawDataLen]||{};n.type=0,n.texture=t,n.count=0,this.drawData[this.drawDataLen]=n,this.drawDataLen++}this.drawData[this.drawDataLen-1].count+=e}},t.prototype.pushDrawText=function(t,e,r,i,a,n){var s=this.drawData[this.drawDataLen]||{};s.type=10,s.texture=t,s.count=e,s.textColor=r,s.stroke=i,s.strokeColor=a,s.texturesInfo=n,this.drawData[this.drawDataLen]=s,this.drawDataLen++},t.prototype.pushDrawTextForCmdBatch=function(t,e,r,i,a,n,s,o,h){var u=this.drawData[this.drawDataLen]||{};u.type=10,u.text=t,u.count=e,u.x=r,u.y=i,u.textColor=a,u.stroke=n,u.strokeColor=s;var f=h,l=f.a,c=f.b,d=f.c,p=f.d,v=f.tx,y=f.ty,g=f.a,E=f.b,T=f.c,m=f.d,x=f.tx-2,_=f.ty-2;f.a=l,f.b=c,f.c=d,f.d=p,f.tx=v,f.ty=y;for(var L=0,R=0,A=0,C=5,S=C*e,b=new Float32Array(S),B=0;e>B;B++){var w=A*C;b[w++]=x,b[w++]=_,b[w++]=0,b[w++]=0,b[w++]=o,b[w++]=g*L+x,b[w++]=E*L+_,b[w++]=0,b[w++]=0,b[w++]=o,b[w++]=g*L+T*R+x,b[w++]=m*R+E*L+_,b[w++]=0,b[w++]=0,b[w++]=o,b[w++]=T*R+x,b[w++]=m*R+_,b[w++]=0,b[w++]=0,b[w++]=o,A+=4}u.transformData=b,this.drawData[this.drawDataLen]=u,this.drawDataLen++},t.prototype.pushPushMask=function(t){void 0===t&&(t=1);var e=this.drawData[this.drawDataLen]||{};e.type=2,e.count=2*t,this.drawData[this.drawDataLen]=e,this.drawDataLen++},t.prototype.pushPopMask=function(t){void 0===t&&(t=1);var e=this.drawData[this.drawDataLen]||{};e.type=3,e.count=2*t,this.drawData[this.drawDataLen]=e,this.drawDataLen++},t.prototype.pushSetBlend=function(t){for(var e=this.drawDataLen,r=!1,i=e-1;i>=0;i--){var a=this.drawData[i];if(a){if((0==a.type||1==a.type)&&(r=!0),!r&&4==a.type){this.drawData.splice(i,1),this.drawDataLen--;continue}if(4==a.type){if(a.value==t)return;break}}}var n=this.drawData[this.drawDataLen]||{};n.type=4,n.value=t,this.drawData[this.drawDataLen]=n,this.drawDataLen++},t.prototype.pushResize=function(t,e,r){var i=this.drawData[this.drawDataLen]||{};i.type=5,i.buffer=t,i.width=e,i.height=r,this.drawData[this.drawDataLen]=i,this.drawDataLen++},t.prototype.pushClearColor=function(){var t=this.drawData[this.drawDataLen]||{};t.type=6,this.drawData[this.drawDataLen]=t,this.drawDataLen++},t.prototype.pushActivateBuffer=function(t){for(var e=this.drawDataLen,r=!1,i=e-1;i>=0;i--){var a=this.drawData[i];!a||(4!=a.type&&7!=a.type&&(r=!0),r||7!=a.type)||(this.drawData.splice(i,1),this.drawDataLen--)}var n=this.drawData[this.drawDataLen]||{};n.type=7,n.buffer=t,n.width=t.rootRenderTarget.width,n.height=t.rootRenderTarget.height,this.drawData[this.drawDataLen]=n,this.drawDataLen++},t.prototype.pushEnableScissor=function(t,e,r,i){var a=this.drawData[this.drawDataLen]||{};a.type=8,a.x=t,a.y=e,a.width=r,a.height=i,this.drawData[this.drawDataLen]=a,this.drawDataLen++},t.prototype.pushDisableScissor=function(){var t=this.drawData[this.drawDataLen]||{};t.type=9,this.drawData[this.drawDataLen]=t,this.drawDataLen++},t.prototype.clear=function(){for(var t=0;t<this.drawDataLen;t++){var e=this.drawData[t];e.type=0,e.count=0,e.texture=null,e.filter=null,e.uv=null,e.value="",e.buffer=null,e.width=0,e.height=0}this.drawDataLen=0},t}();t.WebGLDrawCmdManager=e,__reflect(e.prototype,"egret.native2.WebGLDrawCmdManager")}(e=t.native2||(t.native2={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){var r=function(r){function a(i,a,n){var s=r.call(this)||this;s.globalAlpha=1,s.stencilState=!1,s.$stencilList=[],s.stencilHandleCount=0,s.$scissorState=!1,s.scissorRect=new t.Rectangle,s.$hasScissor=!1,s.dirtyRegionPolicy=!0,s._dirtyRegionPolicy=!0,s.$drawCalls=0,s.$computeDrawCall=!1,s.globalMatrix=new t.Matrix,s.savedGlobalMatrix=new t.Matrix,s.context=e.WebGLRenderContext.getInstance(i,a);var o=s.context.context;if(e.WebGLRenderContext.$supportCmdBatch&&(o=s.context.glCmdManager),s.rootRenderTarget=new e.WebGLRenderTarget(o,3,3),i&&a&&s.resize(i,a),s.root=n,s.root)s.context.pushBuffer(s),s.surface=s.context.surface;else{var h=s.context.activatedBuffer;h&&h.rootRenderTarget.activate(),s.surface=s.rootRenderTarget}return s}return __extends(a,r),a.prototype.enableStencil=function(){this.stencilState||(this.context.enableStencilTest(),this.stencilState=!0)},a.prototype.disableStencil=function(){this.stencilState&&(this.context.disableStencilTest(),this.stencilState=!1)},a.prototype.restoreStencil=function(){this.stencilState?this.context.enableStencilTest():this.context.disableStencilTest()},a.prototype.enableScissor=function(t,e,r,i){this.$scissorState||(this.$scissorState=!0,this.scissorRect.setTo(t,e,r,i),this.context.enableScissorTest(this.scissorRect))},a.prototype.disableScissor=function(){this.$scissorState&&(this.$scissorState=!1,this.scissorRect.setEmpty(),this.context.disableScissorTest())},a.prototype.restoreScissor=function(){this.$scissorState?this.context.enableScissorTest(this.scissorRect):this.context.disableScissorTest()},Object.defineProperty(a.prototype,"width",{get:function(){return this.rootRenderTarget.width},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"height",{get:function(){return this.rootRenderTarget.height},enumerable:!0,configurable:!0}),a.prototype.resize=function(t,e,r){this.context.pushBuffer(this),t=t||1,e=e||1,(t!=this.rootRenderTarget.width||e!=this.rootRenderTarget.height)&&(this.context.drawCmdManager.pushResize(this,t,e),this.rootRenderTarget.width=t,this.rootRenderTarget.height=e),this.root&&this.context.resize(t,e,r),this.context.clear(),this.context.popBuffer()},a.prototype.resizeTo=function(t,e,r,i){this.context.pushBuffer(this);var n=this.rootRenderTarget.width,s=this.rootRenderTarget.height,o=a.create(n,s);this.context.pushBuffer(o),this.context.drawImage(this.rootRenderTarget,0,0,n,s,0,0,n,s,n,s),this.context.popBuffer(),this.resize(t,e),this.setTransform(1,0,0,1,0,0),this.context.drawImage(o.rootRenderTarget,0,0,n,s,r,i,n,s,n,s),a.release(o),this.context.popBuffer()},a.prototype.setDirtyRegionPolicy=function(t){this.dirtyRegionPolicy="on"==t},a.prototype.beginClip=function(t,e,r){this.context.pushBuffer(this),this.root&&(this._dirtyRegionPolicy?(this.rootRenderTarget.useFrameBuffer=!0,this.rootRenderTarget.activate()):(this.rootRenderTarget.useFrameBuffer=!1,this.rootRenderTarget.activate(),a.autoClear&&this.context.clear())),e=+e||0,r=+r||0,this.setTransform(1,0,0,1,e,r);var i=t.length;if(1==i&&0==t[0].minX&&0==t[0].minY&&t[0].width==this.rootRenderTarget.width&&t[0].height==this.rootRenderTarget.height)return this.maskPushed=!1,this.rootRenderTarget.useFrameBuffer&&this.context.clear(),void this.context.popBuffer();for(var n=0;i>n;n++){var s=t[n];this.context.clearRect(s.minX,s.minY,s.width,s.height)}if(i>0){if(this.$hasScissor||1!=i)this.scissorEnabled=!1;else{var s=t[0];t=t.slice(1);var o=s.minX+e,h=s.minY+r,u=s.width,f=s.height;this.context.enableScissor(o,-h-f+this.height,u,f),this.scissorEnabled=!0}t.length>0?(this.context.pushMask(t),this.maskPushed=!0):this.maskPushed=!1,this.offsetX=e,this.offsetY=r}else this.maskPushed=!1;this.context.popBuffer()},a.prototype.endClip=function(){(this.maskPushed||this.scissorEnabled)&&(this.context.pushBuffer(this),this.maskPushed&&(this.setTransform(1,0,0,1,this.offsetX,this.offsetY),this.context.popMask()),this.scissorEnabled&&this.context.disableScissor(),this.context.popBuffer())},a.prototype.getPixels=function(t,e,r,i){void 0===r&&(r=1),void 0===i&&(i=1);var a=new Uint8Array(4*r*i),n=this.rootRenderTarget.useFrameBuffer;this.rootRenderTarget.useFrameBuffer=!0,this.rootRenderTarget.activate(),this.context.getPixels(t,e,r,i,a),this.rootRenderTarget.useFrameBuffer=n,this.rootRenderTarget.activate();for(var s=new Uint8Array(4*r*i),o=0;i>o;o++)for(var h=0;r>h;h++)s[4*(r*(i-o-1)+h)]=a[4*(r*o+h)],s[4*(r*(i-o-1)+h)+1]=a[4*(r*o+h)+1],s[4*(r*(i-o-1)+h)+2]=a[4*(r*o+h)+2],s[4*(r*(i-o-1)+h)+3]=a[4*(r*o+h)+3];return s},a.prototype.toDataURL=function(t,e){return this.context.surface.toDataURL(t,e)},a.prototype.destroy=function(){this.context.destroy()},a.prototype.onRenderFinish=function(){this.$drawCalls=0,this.root&&(!this._dirtyRegionPolicy&&this.dirtyRegionPolicy&&this.drawSurfaceToFrameBuffer(0,0,this.rootRenderTarget.width,this.rootRenderTarget.height,0,0,this.rootRenderTarget.width,this.rootRenderTarget.height,!0),this._dirtyRegionPolicy&&this.drawFrameBufferToSurface(0,0,this.rootRenderTarget.width,this.rootRenderTarget.height,0,0,this.rootRenderTarget.width,this.rootRenderTarget.height),this._dirtyRegionPolicy=this.dirtyRegionPolicy)},a.prototype.onRenderFinish2=function(){this.root&&e.WebGLRenderContext.$supportCmdBatch&&this.context.glCmdManager.flushCmd()},a.prototype.drawFrameBufferToSurface=function(t,e,r,i,a,n,s,o,h){void 0===h&&(h=!1),this.rootRenderTarget.useFrameBuffer=!1,this.rootRenderTarget.activate(),this.context.disableStencilTest(),this.context.disableScissorTest(),this.setTransform(1,0,0,1,0,0),this.globalAlpha=1,this.context.setGlobalCompositeOperation("source-over"),h&&this.context.clear(),this.context.drawImage(this.rootRenderTarget,t,e,r,i,a,n,s,o,r,i),this.context.$drawWebGL(),this.rootRenderTarget.useFrameBuffer=!0,this.rootRenderTarget.activate(),this.restoreStencil(),this.restoreScissor()},a.prototype.drawSurfaceToFrameBuffer=function(t,e,r,i,a,n,s,o,h){void 0===h&&(h=!1),this.rootRenderTarget.useFrameBuffer=!0,this.rootRenderTarget.activate(),this.context.disableStencilTest(),this.context.disableScissorTest(),this.setTransform(1,0,0,1,0,0),this.globalAlpha=1,this.context.setGlobalCompositeOperation("source-over"),h&&this.context.clear(),this.context.drawImage(this.context.surface,t,e,r,i,a,n,s,o,r,i),this.context.$drawWebGL(),this.rootRenderTarget.useFrameBuffer=!1,this.rootRenderTarget.activate(),this.restoreStencil(),this.restoreScissor()},a.prototype.clear=function(){this.context.clear()},a.prototype.setTransform=function(t,e,r,i,a,n){var s=this.globalMatrix;s.a=t,s.b=e,s.c=r,s.d=i,s.tx=a,s.ty=n},a.prototype.transform=function(t,e,r,i,a,n){var s=this.globalMatrix,o=s.a,h=s.b,u=s.c,f=s.d;(1!=t||0!=e||0!=r||1!=i)&&(s.a=t*o+e*u,s.b=t*h+e*f,s.c=r*o+i*u,s.d=r*h+i*f),s.tx=a*o+n*u+s.tx,s.ty=a*h+n*f+s.ty},a.prototype.translate=function(t,e){var r=this.globalMatrix;r.tx+=t,r.ty+=e},a.prototype.saveTransform=function(){var t=this.globalMatrix,e=this.savedGlobalMatrix;e.a=t.a,e.b=t.b,e.c=t.c,e.d=t.d,e.tx=t.tx,e.ty=t.ty},a.prototype.restoreTransform=function(){var t=this.globalMatrix,e=this.savedGlobalMatrix;t.a=e.a,t.b=e.b,t.c=e.c,t.d=e.d,t.tx=e.tx,t.ty=e.ty},a.create=function(t,e){var r=i.pop();if(r){r.resize(t,e);var n=r.globalMatrix;n.a=1,n.b=0,n.c=0,n.d=1,n.tx=0,n.ty=0}else r=new a(t,e),r.$computeDrawCall=!1;return r},a.release=function(t){i.push(t)},a}(t.HashObject);r.autoClear=!0,e.WebGLRenderBuffer=r,__reflect(r.prototype,"egret.native2.WebGLRenderBuffer",["egret.sys.RenderBuffer"]);var i=[]}(e=t.native2||(t.native2={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){function r(t,e){t=isNaN(t)?480:t,e=isNaN(e)?800:e;var r=document.createElement("canvas");return r}var i=function(){function i(t,a){this.glID=null,this.projectionX=0/0,this.projectionY=0/0,this.shaderManager=null,this.contextLost=!1,this.$scissorState=!1,this.vertSize=5,this.blurFilter=null,this.surface=r(t,a),this.initWebGL(),this.$bufferStack=[];var n=this.context;i.$supportCmdBatch&&(n=this.glCmdManager),this.vertexBuffer=n.createBuffer(),this.indexBuffer=n.createBuffer(),n.bindBuffer(n.ARRAY_BUFFER,this.vertexBuffer),n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,this.indexBuffer),this.drawCmdManager=new e.WebGLDrawCmdManager,this.vao=new e.WebGLVertexArrayObject,this.setGlobalCompositeOperation("source-over")}return i.getInstance=function(t,e){return this.instance?this.instance:(this.instance=new i(t,e),this.instance)},i.prototype.pushBuffer=function(t){this.$bufferStack.push(t),t!=this.currentBuffer&&(this.currentBuffer,this.drawCmdManager.pushActivateBuffer(t)),this.currentBuffer=t},i.prototype.popBuffer=function(){if(!(this.$bufferStack.length<=1)){var t=this.$bufferStack.pop(),e=this.$bufferStack[this.$bufferStack.length-1];t!=e&&this.drawCmdManager.pushActivateBuffer(e),this.currentBuffer=e}},i.prototype.activateBuffer=function(t){t.rootRenderTarget.activate(),this.bindIndices||(this.uploadIndicesArray(this.vao.getIndices()),this.bindIndices=!0),t.restoreStencil(),t.restoreScissor(),this.onResize(t.width,t.height)},i.prototype.uploadVerticesArray=function(t){var e=this.context;i.$supportCmdBatch&&(e=this.glCmdManager),e.bufferData(e.ARRAY_BUFFER,t,e.STREAM_DRAW)},i.prototype.uploadIndicesArray=function(t){var e=this.context;i.$supportCmdBatch&&(e=this.glCmdManager),e.bufferData(e.ELEMENT_ARRAY_BUFFER,t,e.STATIC_DRAW)},i.prototype.destroy=function(){this.surface.width=this.surface.height=0},i.prototype.onResize=function(t,e){t=t||this.surface.width,e=e||this.surface.height,this.projectionX=t/2,this.projectionY=-e/2;var r=this.context;i.$supportCmdBatch&&(r=this.glCmdManager),r&&r.viewport(0,0,t,e)},i.prototype.resize=function(t,e,r){var i=this.surface;r?(i.width<t&&(i.width=t),i.height<e&&(i.height=e)):(i.width!=t&&(i.width=t),i.height!=e&&(i.height=e)),this.onResize()},i.prototype.initWebGL=function(){this.onResize(),this.getWebGLContext();var t=this.context;i.$supportCmdBatch&&(t=this.glCmdManager),this.shaderManager=new e.WebGLShaderManager(t)},i.prototype.handleContextLost=function(){this.contextLost=!0},i.prototype.handleContextRestored=function(){this.initWebGL(),this.contextLost=!1},i.prototype.getWebGLContext=function(){for(var r,a={antialias:i.antialias,cmdbatch:i.$supportCmdBatch,stencil:!0},n=["webgl","experimental-webgl"],s=0;s<n.length;s++){try{r=this.surface.getContext(n[s],a)}catch(o){}if(r)break}r||t.$error(1021),1==a.cmdbatch&&(this.glCmdManager=new e.WebGLCmdArrayManager(this.surface,r),this.glCmdManager.initCacheContext()),this.setContext(r)},i.prototype.setContext=function(t){this.context=t,t.id=i.glContextId++,this.glID=t.id;var e=t;i.$supportCmdBatch&&(e=this.glCmdManager),e.disable(e.DEPTH_TEST),e.disable(e.CULL_FACE),e.enable(e.BLEND),e.colorMask(!0,!0,!0,!0),e.activeTexture(e.TEXTURE0)},i.prototype.enableStencilTest=function(){var t=this.context;i.$supportCmdBatch&&(t=this.glCmdManager),t.enable(t.STENCIL_TEST)},i.prototype.disableStencilTest=function(){var t=this.context;i.$supportCmdBatch&&(t=this.glCmdManager),t.disable(t.STENCIL_TEST)},i.prototype.enableScissorTest=function(t){var e=this.context;i.$supportCmdBatch&&(e=this.glCmdManager),e.enable(e.SCISSOR_TEST),e.scissor(t.x,t.y,t.width,t.height)},i.prototype.disableScissorTest=function(){var t=this.context;i.$supportCmdBatch&&(t=this.glCmdManager),t.disable(t.SCISSOR_TEST)},i.prototype.getPixels=function(t,e,r,a,n){var s=this.context;i.$supportCmdBatch&&(s=this.glCmdManager)},i.prototype.createTexture=function(t){var e=this.context,r=!1;i.$supportCmdBatch&&(e=this.glCmdManager,r=!0);var a=e.createTexture();return a?(a.glContext=e,e.bindTexture(e.TEXTURE_2D,a),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,1),r?e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,t):e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,t.source),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),a):void(this.contextLost=!0)},i.prototype.createTextureFromCompressedData=function(t,e,r,i,a){return null},i.prototype.updateTexture=function(t,e){var r=this.context,a=!1;i.$supportCmdBatch&&(r=this.glCmdManager,a=!0),r.bindTexture(r.TEXTURE_2D,t),r.texImage2D(r.TEXTURE_2D,0,r.RGBA,r.RGBA,r.UNSIGNED_BYTE,e)},i.prototype.getWebGLTexture=function(t){return t.webGLTexture||("image"==t.format?t.webGLTexture=this.createTexture(t):"pvr"==t.format&&(t.webGLTexture=this.createTextureFromCompressedData(t.source.pvrtcData,t.width,t.height,t.source.mipmapsCount,t.source.format)),t.$deleteSource&&t.webGLTexture&&(t.source=null)),t.webGLTexture},i.prototype.clearRect=function(t,e,r,i){if(0!=t||0!=e||r!=this.surface.width||i!=this.surface.height){var a=this.currentBuffer;if(a.$hasScissor)this.setGlobalCompositeOperation("destination-out"),this.drawRect(t,e,r,i),this.setGlobalCompositeOperation("source-over");else{var n=a.globalMatrix;0==n.b&&0==n.c?(t=t*n.a+n.tx,e=e*n.d+n.ty,r*=n.a,i*=n.d,this.enableScissor(t,-e-i+a.height,r,i),this.clear(),this.disableScissor()):(this.setGlobalCompositeOperation("destination-out"),this.drawRect(t,e,r,i),this.setGlobalCompositeOperation("source-over"))}}else this.clear()},i.prototype.setGlobalCompositeOperation=function(t){this.drawCmdManager.pushSetBlend(t)},i.prototype.drawImage=function(t,e,r,i,a,n,s,o,h,u,f){var l=this.currentBuffer;if(!this.contextLost&&t&&l){var c;if(t.texture||t.source&&t.source.texture)c=t.texture||t.source.texture,l.saveTransform(),l.transform(1,0,0,-1,0,h+2*s);else{if(!t.source&&!t.webGLTexture)return;c=this.getWebGLTexture(t)}c&&(this.drawTexture(c,e,r,i,a,n,s,o,h,u,f),t.source&&t.source.texture&&l.restoreTransform())}},i.prototype.drawMesh=function(t,e,r,i,a,n,s,o,h,u,f,l,c,d,p){var v=this.currentBuffer;if(!this.contextLost&&t&&v){var y;if(t.texture||t.source&&t.source.texture)y=t.texture||t.source.texture,v.saveTransform(),v.transform(1,0,0,-1,0,h+2*s);else{if(!t.source&&!t.webGLTexture)return;y=this.getWebGLTexture(t)}y&&this.drawTexture(y,e,r,i,a,n,s,o,h,u,f,l,c,d,p)}},i.prototype.drawTexture=function(t,e,r,i,a,n,s,o,h,u,f,l,c,d,p){var v=this.currentBuffer;if(!this.contextLost&&t&&v){c&&d?this.vao.reachMaxSize(c.length/2,d.length)&&this.$drawWebGL():this.vao.reachMaxSize()&&this.$drawWebGL(),l&&this.vao.changeToMeshIndices();var y=v.globalMatrix,g=v.globalAlpha,E=d?d.length/3:2;this.drawCmdManager.pushDrawTexture(t,E,this.$filter),this.vao.cacheArrays(y,g,e,r,i,a,n,s,o,h,u,f,l,c,d)}},i.prototype.drawTextForCmdBatch=function(t,e,r,i,a,n,s){var o=this.currentBuffer;if(!this.contextLost&&o){var h=o.globalMatrix,u=o.globalAlpha;this.drawCmdManager.pushDrawTextForCmdBatch(t,t.length,r,i,a,n,s,u,h)}},i.prototype.drawRect=function(t,e,r,i){var a=this.currentBuffer;!this.contextLost&&a&&(this.vao.reachMaxSize()&&this.$drawWebGL(),this.drawCmdManager.pushDrawRect(),this.vao.cacheArrays(a.globalMatrix,a.globalAlpha,0,0,r,i,t,e,r,i,r,i))},i.prototype.pushMask=function(t){var e=this.currentBuffer;if(!this.contextLost&&e){e.$stencilList.push(t),this.vao.reachMaxSize()&&this.$drawWebGL();var r=t.length;if(r){this.drawCmdManager.pushPushMask(r);for(var i=0;r>i;i++){var a=t[i];this.vao.cacheArrays(e.globalMatrix,e.globalAlpha,0,0,a.width,a.height,a.minX,a.minY,a.width,a.height,a.width,a.height)}}else this.drawCmdManager.pushPushMask(),this.vao.cacheArrays(e.globalMatrix,e.globalAlpha,0,0,t.width,t.height,t.x,t.y,t.width,t.height,t.width,t.height)}},i.prototype.popMask=function(){var t=this.currentBuffer;if(!this.contextLost&&t){var e=t.$stencilList.pop();this.vao.reachMaxSize()&&this.$drawWebGL();var r=e.length;if(r){this.drawCmdManager.pushPopMask(r);for(var i=0;r>i;i++){var a=e[i];this.vao.cacheArrays(t.globalMatrix,t.globalAlpha,0,0,a.width,a.height,a.minX,a.minY,a.width,a.height,a.width,a.height)}}else this.drawCmdManager.pushPopMask(),this.vao.cacheArrays(t.globalMatrix,t.globalAlpha,0,0,e.width,e.height,e.x,e.y,e.width,e.height,e.width,e.height)}},i.prototype.clear=function(){this.drawCmdManager.pushClearColor()},i.prototype.enableScissor=function(t,e,r,i){var a=this.currentBuffer;this.drawCmdManager.pushEnableScissor(t,e,r,i),a.$hasScissor=!0},i.prototype.disableScissor=function(){var t=this.currentBuffer;this.drawCmdManager.pushDisableScissor(),t.$hasScissor=!1},i.prototype.$drawWebGL=function(){if(0!=this.drawCmdManager.drawDataLen&&!this.contextLost){this.uploadVerticesArray(this.vao.getVertices()),this.vao.isMesh()&&this.uploadIndicesArray(this.vao.getMeshIndices());for(var t=this.drawCmdManager.drawDataLen,e=0,r=0;t>r;r++){var a=this.drawCmdManager.drawData[r];e=this.drawData(a,e),7==a.type&&(this.activatedBuffer=a.buffer),(0==a.type||1==a.type||2==a.type||3==a.type)&&this.activatedBuffer&&this.activatedBuffer.$computeDrawCall&&this.activatedBuffer.$drawCalls++}this.vao.isMesh()&&this.uploadIndicesArray(this.vao.getIndices()),i.$supportCmdBatch&&this.glCmdManager.flushCmd(),this.drawCmdManager.clear(),this.vao.clear()}},i.prototype.drawData=function(t,e){if(t){var r;switch(t.type){case 0:var i=t.filter;i?"colorTransform"==i.type?(r=this.shaderManager.colorTransformShader,r.setMatrix(i.$matrix)):"blur"==i.type?(r=this.shaderManager.blurShader,r.setBlur(i.$blurX,i.$blurY),r.setTextureSize(t.textureWidth,t.textureHeight)):"glow"==i.type&&(r=this.shaderManager.glowShader,r.setDistance(i.$distance||0),r.setAngle(i.$angle?i.$angle/180*Math.PI:0),r.setColor(i.$red/255,i.$green/255,i.$blue/255),r.setAlpha(i.$alpha),r.setBlurX(i.$blurX),r.setBlurY(i.$blurY),r.setStrength(i.$strength),r.setInner(i.$inner?1:0),r.setKnockout(i.$knockout?0:1),r.setHideObject(i.$hideObject?1:0),r.setTextureSize(t.textureWidth,t.textureHeight)):r=this.shaderManager.defaultShader,r.setProjection(this.projectionX,this.projectionY),this.shaderManager.activateShader(r,4*this.vertSize),r.syncUniforms(),e+=this.drawTextureElements(t,e);break;case 1:r=this.shaderManager.primitiveShader,r.setProjection(this.projectionX,this.projectionY),this.shaderManager.activateShader(r,4*this.vertSize),r.syncUniforms(),e+=this.drawRectElements(t,e);break;case 2:r=this.shaderManager.primitiveShader,r.setProjection(this.projectionX,this.projectionY),this.shaderManager.activateShader(r,4*this.vertSize),r.syncUniforms(),e+=this.drawPushMaskElements(t,e);break;case 3:r=this.shaderManager.primitiveShader,r.setProjection(this.projectionX,this.projectionY),this.shaderManager.activateShader(r,4*this.vertSize),r.syncUniforms(),e+=this.drawPopMaskElements(t,e);break;case 4:this.setBlendMode(t.value);break;case 5:t.buffer.rootRenderTarget.resize(t.width,t.height),this.onResize(t.width,t.height);break;case 6:if(this.activatedBuffer){var a=this.activatedBuffer.rootRenderTarget;(0!=a.width||0!=a.height)&&a.clear()}break;case 7:this.activateBuffer(t.buffer);break;case 8:var n=this.activatedBuffer;n&&n.enableScissor(t.x,t.y,t.width,t.height);break;case 9:n=this.activatedBuffer,n&&n.disableScissor()}return e}},i.prototype.drawTextureElements=function(t,e){var r=this.context;i.$supportCmdBatch&&(r=this.glCmdManager),r.bindTexture(r.TEXTURE_2D,t.texture);var a=3*t.count;return r.drawElements(r.TRIANGLES,a,r.UNSIGNED_SHORT,2*e),a},i.prototype.drawRectElements=function(t,e){var r=this.context;i.$supportCmdBatch&&(r=this.glCmdManager);var a=3*t.count;return r.drawElements(r.TRIANGLES,a,r.UNSIGNED_SHORT,2*e),a},i.prototype.drawPushMaskElements=function(t,e){var r=this.context;i.$supportCmdBatch&&(r=this.glCmdManager);var a=3*t.count,n=this.activatedBuffer;if(n){0==n.stencilHandleCount&&(n.enableStencil(),r.clear(r.STENCIL_BUFFER_BIT));var s=n.stencilHandleCount;n.stencilHandleCount++,r.colorMask(!1,!1,!1,!1),r.stencilFunc(r.EQUAL,s,255),r.stencilOp(r.KEEP,r.KEEP,r.INCR),r.drawElements(r.TRIANGLES,a,r.UNSIGNED_SHORT,2*e),r.stencilFunc(r.EQUAL,s+1,255),r.colorMask(!0,!0,!0,!0),r.stencilOp(r.KEEP,r.KEEP,r.KEEP)}return a},i.prototype.drawPopMaskElements=function(t,e){var r=this.context;i.$supportCmdBatch&&(r=this.glCmdManager);var a=3*t.count,n=this.activatedBuffer;if(n)if(n.stencilHandleCount--,0==n.stencilHandleCount)n.disableStencil();else{var s=n.stencilHandleCount;r.colorMask(!1,!1,!1,!1),r.stencilFunc(r.EQUAL,s+1,255),r.stencilOp(r.KEEP,r.KEEP,r.DECR),r.drawElements(r.TRIANGLES,a,r.UNSIGNED_SHORT,2*e),r.stencilFunc(r.EQUAL,s,255),r.colorMask(!0,!0,!0,!0),r.stencilOp(r.KEEP,r.KEEP,r.KEEP)}return a},i.prototype.setBlendMode=function(t){var e=this.context;i.$supportCmdBatch&&(e=this.glCmdManager);var r=i.blendModesForGL[t];r&&e.blendFunc(r[0],r[1])},i.prototype.drawTargetWidthFilters=function(t,r){var i,a=r,n=t.length;if(n>1)for(var s=0;n-1>s;s++){var o=t[s],h=r.rootRenderTarget.width,u=r.rootRenderTarget.height;i=e.WebGLRenderBuffer.create(h,u),i.setTransform(1,0,0,1,0,0),i.globalAlpha=1,this.drawToRenderTarget(o,r,i),r!=a&&e.WebGLRenderBuffer.release(r),r=i}var f=t[n-1];this.drawToRenderTarget(f,r,this.currentBuffer),r!=a&&e.WebGLRenderBuffer.release(r)},i.prototype.drawToRenderTarget=function(r,i,a){if(!this.contextLost){this.vao.reachMaxSize()&&this.$drawWebGL(),this.pushBuffer(a);var n,s=i,o=i.rootRenderTarget.width,h=i.rootRenderTarget.height;"blur"==r.type&&(this.blurFilter||(this.blurFilter=new t.BlurFilter(2,2)),0!=r.blurX&&0!=r.blurY?(this.blurFilter.blurX=r.blurX,this.blurFilter.blurY=0,n=e.WebGLRenderBuffer.create(o,h),n.setTransform(1,0,0,1,0,0),n.globalAlpha=1,this.drawToRenderTarget(this.blurFilter,i,n),i!=s&&e.WebGLRenderBuffer.release(i),i=n,this.blurFilter.blurX=0,this.blurFilter.blurY=r.blurY):(this.blurFilter.blurX=r.blurX,this.blurFilter.blurY=r.blurY),r=this.blurFilter),a.saveTransform(),a.transform(1,0,0,-1,0,h),this.vao.cacheArrays(a.globalMatrix,a.globalAlpha,0,0,o,h,0,0,o,h,o,h),a.restoreTransform();var u;u="blur"==r.type?{type:"blur",$blurX:r.$blurX,$blurY:r.$blurY}:r,this.drawCmdManager.pushDrawTexture(i.rootRenderTarget.texture,2,u,o,h),i!=s&&e.WebGLRenderBuffer.release(i),this.popBuffer()
}},i.initBlendMode=function(){i.blendModesForGL={},i.blendModesForGL["source-over"]=[1,771],i.blendModesForGL.lighter=[1,1],i.blendModesForGL["lighter-in"]=[770,771],i.blendModesForGL["destination-out"]=[0,771],i.blendModesForGL["destination-in"]=[0,770]},i}();i.glContextId=0,i.blendModesForGL=null,e.WebGLRenderContext=i,__reflect(i.prototype,"egret.native2.WebGLRenderContext"),i.initBlendMode()}(e=t.native2||(t.native2={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){var r=["source-over","lighter","destination-out"],i="source-over",a=[],n=function(){function n(){this.nestLevel=0}return n.prototype.render=function(t,e,r,i,n){this.nestLevel++;var s=e,o=s.context,h=n?t:null;o.pushBuffer(s),this.drawDisplayObject(t,s,i,r,null,null,h),o.$drawWebGL();var u=s.$drawCalls;if(s.onRenderFinish(),o.popBuffer(),this.nestLevel--,0===this.nestLevel){a.length>6&&(a.length=6);for(var f=a.length,l=0;f>l;l++)a[l].resize(0,0)}return s.onRenderFinish2(),u},n.prototype.drawDisplayObject=function(e,r,i,a,n,s,o){var h,u=0;if(n&&!o?(n.isDirty&&(u+=n.drawToSurface()),h=n.$renderNode):h=e.$getRenderNode(),h){if(i){var f=h.renderRegion;if(s&&!s.intersects(f))h.needRedraw=!1;else if(!h.needRedraw)for(var l=i.length,c=0;l>c;c++)if(f.intersects(i[c])){h.needRedraw=!0;break}}else h.needRedraw=!0;if(h.needRedraw){u++;var d=void 0,p=void 0;o?(d=e.$getConcatenatedAlphaAt(o,e.$getConcatenatedAlpha()),p=t.Matrix.create().copyFrom(e.$getConcatenatedMatrix()),e.$getConcatenatedMatrixAt(o,p),a.$preMultiplyInto(p,p),r.setTransform(p.a,p.b,p.c,p.d,p.tx,p.ty),t.Matrix.release(p)):(d=h.renderAlpha,p=h.renderMatrix,r.setTransform(p.a,p.b,p.c,p.d,p.tx+a.tx,p.ty+a.ty)),r.globalAlpha=d,this.renderNode(h,r),h.needRedraw=!1}}if(n&&!o)return u;var v=e.$children;if(v)for(var y=v.length,g=0;y>g;g++){var E=v[g];if(!(!E.$visible||E.$alpha<=0||E.$maskedObject)){var T=E.$getFilters();T&&T.length>0?u+=this.drawWithFilter(E,r,i,a,s,o):0!==E.$blendMode||E.$mask&&(E.$mask.$parentDisplayList||o)?u+=this.drawWithClip(E,r,i,a,s,o):E.$scrollRect||E.$maskRect?u+=this.drawWithScrollRect(E,r,i,a,s,o):E.isFPS?(r.context.$drawWebGL(),r.$computeDrawCall=!1,this.drawDisplayObject(E,r,i,a,E.$displayList,s,o),r.context.$drawWebGL(),r.$computeDrawCall=!0):u+=this.drawDisplayObject(E,r,i,a,E.$displayList,s,o)}}return u},n.prototype.drawWithFilter=function(e,n,s,o,h,u){var f,l=0,c=e.$getFilters(),d=0!==e.$blendMode;if(d&&(f=r[e.$blendMode],f||(f=i)),1==c.length&&"colorTransform"==c[0].type&&!e.$children)return d&&n.context.setGlobalCompositeOperation(f),n.context.$filter=c[0],l+=e.$mask&&(e.$mask.$parentDisplayList||u)?this.drawWithClip(e,n,s,o,h,u):e.$scrollRect||e.$maskRect?this.drawWithScrollRect(e,n,s,o,h,u):this.drawDisplayObject(e,n,s,o,e.$displayList,h,u),n.context.$filter=null,d&&n.context.setGlobalCompositeOperation(i),l;var p=t.Matrix.create();p.copyFrom(e.$getConcatenatedMatrix()),u&&e.$getConcatenatedMatrixAt(u,p);var v;v=t.sys.Region.create();var y=e.$getOriginalBounds();v.updateRegion(y,p);var g=this.createRenderBuffer(v.width,v.height);g.context.pushBuffer(g),g.setTransform(1,0,0,1,-v.minX,-v.minY);var E=t.Matrix.create().setTo(1,0,0,1,-v.minX,-v.minY);return l+=e.$mask&&(e.$mask.$parentDisplayList||u)?this.drawWithClip(e,g,s,E,v,u):e.$scrollRect||e.$maskRect?this.drawWithScrollRect(e,g,s,E,v,u):this.drawDisplayObject(e,g,s,E,e.$displayList,v,u),t.Matrix.release(E),g.context.popBuffer(),l>0&&(d&&n.context.setGlobalCompositeOperation(f),l++,n.globalAlpha=1,n.setTransform(1,0,0,1,v.minX+o.tx,v.minY+o.ty),n.context.drawTargetWidthFilters(c,g),d&&n.context.setGlobalCompositeOperation(i)),a.push(g),t.sys.Region.release(v),t.Matrix.release(p),l},n.prototype.drawWithClip=function(e,n,s,o,h,u){var f,l=0,c=0!==e.$blendMode;c&&(f=r[e.$blendMode],f||(f=i));var d=e.$scrollRect?e.$scrollRect:e.$maskRect,p=e.$mask;if(p){var v=p.$getRenderNode();if(v){var y=v.renderMatrix;if(0==y.a&&0==y.b||0==y.c&&0==y.d)return l}}var g,E=t.Matrix.create();if(E.copyFrom(e.$getConcatenatedMatrix()),e.$parentDisplayList){var T=e.$parentDisplayList.root;T!==e.$stage&&e.$getConcatenatedMatrixAt(T,E)}var m;if(p){m=p.$getOriginalBounds(),g=t.sys.Region.create();var x=t.Matrix.create();x.copyFrom(p.$getConcatenatedMatrix()),g.updateRegion(m,x),t.Matrix.release(x)}var _;if(d&&(_=t.sys.Region.create(),_.updateRegion(d,E)),_&&g?(_.intersect(g),t.sys.Region.release(g)):!_&&g&&(_=g),_){if(_.isEmpty()||h&&!h.intersects(_))return t.sys.Region.release(_),t.Matrix.release(E),l}else _=t.sys.Region.create(),m=e.$getOriginalBounds(),_.updateRegion(m,E);var L=!1;if(s){for(var R=s.length,A=0;R>A;A++)if(_.intersects(s[A])){L=!0;break}}else L=!0;if(!L)return t.sys.Region.release(_),t.Matrix.release(E),l;if(p||e.$children&&0!=e.$children.length){var C=this.createRenderBuffer(_.width,_.height);C.context.pushBuffer(C),C.setTransform(1,0,0,1,-_.minX,-_.minY);var S=t.Matrix.create().setTo(1,0,0,1,-_.minX,-_.minY);if(l+=this.drawDisplayObject(e,C,s,S,e.$displayList,_,u),p){var b=this.createRenderBuffer(_.width,_.height);b.context.pushBuffer(b),b.setTransform(1,0,0,1,-_.minX,-_.minY),S=t.Matrix.create().setTo(1,0,0,1,-_.minX,-_.minY),l+=this.drawDisplayObject(p,b,s,S,p.$displayList,_,u),b.context.popBuffer(),C.context.setGlobalCompositeOperation("destination-in"),C.setTransform(1,0,0,-1,0,b.height),C.globalAlpha=1;var B=b.rootRenderTarget.width,w=b.rootRenderTarget.height;C.context.drawTexture(b.rootRenderTarget.texture,0,0,B,w,0,0,B,w,B,w),C.context.setGlobalCompositeOperation("source-over"),a.push(b)}if(t.Matrix.release(S),C.context.setGlobalCompositeOperation(i),C.context.popBuffer(),l>0){if(l++,c&&n.context.setGlobalCompositeOperation(f),d){var x=E;C.setTransform(x.a,x.b,x.c,x.d,x.tx-_.minX,x.ty-_.minY),C.context.pushMask(d)}n.globalAlpha=1,n.setTransform(1,0,0,-1,_.minX+o.tx,_.minY+o.ty+C.height);var U=C.rootRenderTarget.width,I=C.rootRenderTarget.height;n.context.drawTexture(C.rootRenderTarget.texture,0,0,U,I,0,0,U,I,U,I),d&&C.context.popMask(),c&&n.context.setGlobalCompositeOperation(i)}return a.push(C),t.sys.Region.release(_),t.Matrix.release(E),l}if(d){var x=E;n.setTransform(x.a,x.b,x.c,x.d,x.tx-_.minX,x.ty-_.minY),n.context.pushMask(d)}return c&&n.context.setGlobalCompositeOperation(f),l+=this.drawDisplayObject(e,n,s,o,e.$displayList,h,u),c&&n.context.setGlobalCompositeOperation(i),d&&n.context.popMask(),t.sys.Region.release(_),t.Matrix.release(E),l},n.prototype.drawWithScrollRect=function(e,r,i,a,n,s){var o=0,h=e.$scrollRect?e.$scrollRect:e.$maskRect;if(h.isEmpty())return o;var u=t.Matrix.create();if(u.copyFrom(e.$getConcatenatedMatrix()),s)e.$getConcatenatedMatrixAt(s,u);else if(e.$parentDisplayList){var f=e.$parentDisplayList.root;f!==e.$stage&&e.$getConcatenatedMatrixAt(f,u)}var l=t.sys.Region.create();if(l.updateRegion(h,u),l.isEmpty()||n&&!n.intersects(l))return t.sys.Region.release(l),t.Matrix.release(u),o;var c=!1;if(i){for(var d=i.length,p=0;d>p;p++)if(l.intersects(i[p])){c=!0;break}}else c=!0;if(!c)return t.sys.Region.release(l),t.Matrix.release(u),o;r.setTransform(u.a,u.b,u.c,u.d,u.tx+a.tx,u.ty+a.ty);var v=r.context,y=!1;if(r.$hasScissor||0!=u.b||0!=u.c)v.pushMask(h);else{var g=u.a,E=u.d,T=u.tx,m=u.ty,x=h.x,_=h.y,L=x+h.width,R=_+h.height,A=void 0,C=void 0,S=void 0,b=void 0;if(1==g&&1==E)A=x+T,C=_+m,S=L+T,b=R+m;else{var B=g*x+T,w=E*_+m,U=g*L+T,I=E*_+m,F=g*L+T,D=E*R+m,M=g*x+T,O=E*R+m,N=0;B>U&&(N=B,B=U,U=N),F>M&&(N=F,F=M,M=N),A=F>B?B:F,S=U>M?U:M,w>I&&(N=w,w=I,I=N),D>O&&(N=D,D=O,O=N),C=D>w?w:D,b=I>O?I:O}v.enableScissor(A+a.tx,-a.ty-b+r.height,S-A,b-C),y=!0}return o+=this.drawDisplayObject(e,r,i,a,e.$displayList,l,s),r.setTransform(u.a,u.b,u.c,u.d,u.tx+a.tx,u.ty+a.ty),y?v.disableScissor():v.popMask(),t.sys.Region.release(l),t.Matrix.release(u),o},n.prototype.drawNodeToBuffer=function(t,e,r,i){var a=e;a.context.pushBuffer(a),a.setTransform(r.a,r.b,r.c,r.d,r.tx,r.ty),this.renderNode(t,e,i),a.context.$drawWebGL(),a.onRenderFinish(),a.context.popBuffer()},n.prototype.renderNode=function(t,e,r){switch(t.type){case 1:this.renderBitmap(t,e);break;case 2:this.renderText(t,e);break;case 3:this.renderGraphics(t,e,r);break;case 4:this.renderGroup(t,e);break;case 6:e.globalAlpha=t.drawData[0];break;case 7:this.renderMesh(t,e)}},n.prototype.renderBitmap=function(t,e){var a=t.image;if(a){var n=t.drawData,s=n.length,o=0,h=t.matrix,u=t.blendMode,f=t.alpha;h&&(e.saveTransform(),e.transform(h.a,h.b,h.c,h.d,h.tx,h.ty)),u&&e.context.setGlobalCompositeOperation(r[u]);var l;if(f==f&&(l=e.globalAlpha,e.globalAlpha*=f),t.filter){for(e.context.$filter=t.filter;s>o;)e.context.drawImage(a,n[o++],n[o++],n[o++],n[o++],n[o++],n[o++],n[o++],n[o++],t.imageWidth,t.imageHeight);e.context.$filter=null}else for(;s>o;)e.context.drawImage(a,n[o++],n[o++],n[o++],n[o++],n[o++],n[o++],n[o++],n[o++],t.imageWidth,t.imageHeight);u&&e.context.setGlobalCompositeOperation(i),f==f&&(e.globalAlpha=l),h&&e.restoreTransform()}},n.prototype.renderMesh=function(t,e){var r=t.image,i=t.drawData,a=i.length,n=0,s=t.matrix;for(s&&(e.saveTransform(),e.transform(s.a,s.b,s.c,s.d,s.tx,s.ty));a>n;)e.context.drawMesh(r,i[n++],i[n++],i[n++],i[n++],i[n++],i[n++],i[n++],i[n++],t.imageWidth,t.imageHeight,t.uvs,t.vertices,t.indices,t.bounds);s&&e.restoreTransform()},n.prototype.renderText=function(t,e){var r=t.width-t.x,i=t.height-t.y;if((t.x||t.y)&&e.transform(1,0,0,1,t.x,t.y),!t.$texture){var a=window.canvas,n=a.getContext("webgl"),s=n,o=s.createTexture();if(!o)return void console.log("------ !texture");s.bindTexture(s.TEXTURE_2D,o),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MAG_FILTER,s.LINEAR),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MIN_FILTER,s.LINEAR),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_S,s.CLAMP_TO_EDGE),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_T,s.CLAMP_TO_EDGE),t.$texture=o}if(t.dirtyRender){egret_native.Label.bindTexture(t.$texture,r,i);for(var h=t.drawData,u=h.length,f=0;u>f;){var l=h[f++],c=h[f++],d=h[f++],p=h[f++],v=null==p.size?t.size:p.size,y=null==p.textColor?t.textColor:p.textColor,g=null==p.stroke?t.stroke:p.stroke,E=null==p.strokeColor?t.strokeColor:p.strokeColor;egret_native.Label.drawText(l,c,d,v,y,g,E)}egret_native.Label.generateTexture(),t.$textureWidth=r,t.$textureHeight=i}var T=t.$textureWidth,m=t.$textureHeight;e.context.drawTexture(t.$texture,0,0,T,m,0,0,T,m,T,m),(t.x||t.y)&&e.transform(1,0,0,1,-t.x,-t.y),t.dirtyRender=!1},n.prototype.renderGraphics=function(t,e,r){return},n.prototype.renderGroup=function(t,e){var r=t.matrix;r&&(e.saveTransform(),e.transform(r.a,r.b,r.c,r.d,r.tx,r.ty));for(var i=t.drawData,a=i.length,n=0;a>n;n++){var s=i[n];this.renderNode(s,e)}r&&e.restoreTransform()},n.prototype.createRenderBuffer=function(t,r){var i=a.pop();return i?i.resize(t,r):(i=new e.WebGLRenderBuffer(t,r),i.$computeDrawCall=!1),i},n}();e.WebGLRenderer=n,__reflect(n.prototype,"egret.native2.WebGLRenderer",["egret.sys.SystemRenderer"])}(e=t.native2||(t.native2={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){var r=function(t){function r(e,r,i){var a=t.call(this)||this;return a.clearColor=[0,0,0,0],a.useFrameBuffer=!0,a.gl=e,a.width=r||1,a.height=i||1,a.texture=a.createTexture(),a.frameBuffer=e.createFramebuffer(),e.bindFramebuffer(e.FRAMEBUFFER,a.frameBuffer),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,a.texture,0),a.stencilBuffer=e.createRenderbuffer(),e.bindRenderbuffer(e.RENDERBUFFER,a.stencilBuffer),e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_STENCIL,a.width,a.height),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.RENDERBUFFER,a.stencilBuffer),a}return __extends(r,t),r.prototype.resize=function(t,r){var i=this.gl;i.bindTexture(i.TEXTURE_2D,this.texture),e.WebGLRenderContext.$supportCmdBatch?i.texImage2Di(i.TEXTURE_2D,0,i.RGBA,t,r,0,i.RGBA,i.UNSIGNED_BYTE,null):i.texImage2D(i.TEXTURE_2D,0,i.RGBA,t,r,0,i.RGBA,i.UNSIGNED_BYTE,null),i.bindFramebuffer(i.FRAMEBUFFER,this.frameBuffer),i.deleteRenderbuffer(this.stencilBuffer),this.stencilBuffer=i.createRenderbuffer(),i.bindRenderbuffer(i.RENDERBUFFER,this.stencilBuffer),i.renderbufferStorage(i.RENDERBUFFER,i.DEPTH_STENCIL,t,r),this.width=t,this.height=r},r.prototype.activate=function(){var t=this.gl;t.bindFramebuffer(t.FRAMEBUFFER,this.getFrameBuffer())},r.prototype.getFrameBuffer=function(){return this.useFrameBuffer?this.frameBuffer:null},r.prototype.createTexture=function(){var t=this.gl,r=t.createTexture();return t.bindTexture(t.TEXTURE_2D,r),e.WebGLRenderContext.$supportCmdBatch?t.texImage2Di(t.TEXTURE_2D,0,t.RGBA,this.width,this.height,0,t.RGBA,t.UNSIGNED_BYTE,null):t.texImage2D(t.TEXTURE_2D,0,t.RGBA,this.width,this.height,0,t.RGBA,t.UNSIGNED_BYTE,null),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),r},r.prototype.clear=function(t){var e=this.gl;t&&this.activate(),e.colorMask(!0,!0,!0,!0),e.clearColor(this.clearColor[0],this.clearColor[1],this.clearColor[2],this.clearColor[3]),e.clear(e.COLOR_BUFFER_BIT)},r}(t.HashObject);e.WebGLRenderTarget=r,__reflect(r.prototype,"egret.native2.WebGLRenderTarget")}(e=t.native2||(t.native2={}))}(egret||(egret={}));var egret;!function(t){var e;!function(t){var e=function(){function e(t){this.gl=null,this.maxAttibs=10,this.attribState=[],this.tempAttribState=[],this.currentShader=null,this.defaultShader=null,this.primitiveShader=null,this.colorTransformShader=null,this.blurShader=null,this.glowShader=null,this.fontShader=null;for(var e=0;e<this.maxAttibs;e++)this.attribState[e]=!1;this.setContext(t)}return e.prototype.setContext=function(e){this.gl=e,this.primitiveShader=new t.PrimitiveShader(e),this.defaultShader=new t.TextureShader(e),this.colorTransformShader=new t.ColorTransformShader(e),this.glowShader=new t.GlowShader(e),this.blurShader=new t.BlurShader(e),this.fontShader=new t.FontShader(e),this.primitiveShader.init(),this.defaultShader.init(),this.colorTransformShader.init(),this.blurShader.init(),this.glowShader.init(),this.fontShader.init()},e.prototype.activateShader=function(t,e){this.currentShader!=t&&(this.gl.useProgram(t.program),this.gl.flushCmd?this.setAttribForCmdBatch(t.attributes):this.setAttribs(t.attributes),t.setAttribPointer(e),this.currentShader=t)},e.prototype.setAttribForCmdBatch=function(t){var e,r,i=this.gl;for(r=t.length,e=0;r>e;e++)i.enableVertexAttribArray(t[e])},e.prototype.setAttribs=function(t){var e,r;for(r=this.tempAttribState.length,e=0;r>e;e++)this.tempAttribState[e]=!1;for(r=t.length,e=0;r>e;e++){var i=t[e];this.tempAttribState[i]=!0}var a=this.gl;for(r=this.attribState.length,e=0;r>e;e++)this.attribState[e]!==this.tempAttribState[e]&&(this.attribState[e]=this.tempAttribState[e],this.tempAttribState[e]?a.enableVertexAttribArray(e):a.disableVertexAttribArray(e))},e}();t.WebGLShaderManager=e,__reflect(e.prototype,"egret.native2.WebGLShaderManager")}(e=t.native2||(t.native2={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){var r=function(){function e(){}return e.compileProgram=function(r,i,a){var n=e.compileFragmentShader(r,a),s=e.compileVertexShader(r,i),o=r.createProgram();return r.attachShader(o,s),r.attachShader(o,n),r.linkProgram(o),r.getProgramParameter(o,r.LINK_STATUS)||t.$warn(1020),o},e.compileFragmentShader=function(t,r){return e._compileShader(t,r,t.FRAGMENT_SHADER)},e.compileVertexShader=function(t,r){return e._compileShader(t,r,t.VERTEX_SHADER)},e._compileShader=function(t,e,r){var i=t.createShader(r);return t.shaderSource(i,e),t.compileShader(i),t.getShaderParameter(i,t.COMPILE_STATUS)?i:null},e.checkCanUseWebGL=function(){if(void 0==e.canUseWebGL)try{var t=document.createElement("canvas");e.canUseWebGL=!(!window.WebGLRenderingContext||!t.getContext("webgl")&&!t.getContext("experimental-webgl"))}catch(r){e.canUseWebGL=!1}return e.canUseWebGL},e.deleteWebGLTexture=function(t){if(t){var e=t.glContext;e&&e.deleteTexture(t)}},e}();e.WebGLUtils=r,__reflect(r.prototype,"egret.native2.WebGLUtils")}(e=t.native2||(t.native2={}))}(egret||(egret={}));var egret;!function(t){var e;!function(t){var e=function(){function t(){this.size=2e3,this.vertexMaxSize=4*this.size,this.indicesMaxSize=6*this.size,this.vertSize=5,this.vertices=null,this.indices=null,this.indicesForMesh=null,this.vertexIndex=0,this.indexIndex=0,this.hasMesh=!1;var t=this.vertexMaxSize*this.vertSize,e=this.indicesMaxSize;this.vertices=new Float32Array(t),this.indices=new Uint16Array(e),this.indicesForMesh=new Uint16Array(e);for(var r=0,i=0;e>r;r+=6,i+=4)this.indices[r+0]=i+0,this.indices[r+1]=i+1,this.indices[r+2]=i+2,this.indices[r+3]=i+0,this.indices[r+4]=i+2,this.indices[r+5]=i+3}return t.prototype.reachMaxSize=function(t,e){return void 0===t&&(t=4),void 0===e&&(e=6),this.vertexIndex>this.vertexMaxSize-t||this.indexIndex>this.indicesMaxSize-e},t.prototype.getVertices=function(){var t=this.vertices.subarray(0,this.vertexIndex*this.vertSize);return t},t.prototype.getIndices=function(){return this.indices},t.prototype.getMeshIndices=function(){return this.indicesForMesh},t.prototype.changeToMeshIndices=function(){if(!this.hasMesh){for(var t=0,e=this.indexIndex;e>t;++t)this.indicesForMesh[t]=this.indices[t];this.hasMesh=!0}},t.prototype.isMesh=function(){return this.hasMesh},t.prototype.cacheArrays=function(t,e,r,i,a,n,s,o,h,u,f,l,c,d,p){var v=t,y=v.a,g=v.b,E=v.c,T=v.d,m=v.tx,x=v.ty;(0!=s||0!=o)&&v.append(1,0,0,1,s,o),(a/h!=1||n/u!=1)&&v.append(h/a,0,0,u/n,0,0);var _=v.a,L=v.b,R=v.c,A=v.d,C=v.tx,S=v.ty;if(v.a=y,v.b=g,v.c=E,v.d=T,v.tx=m,v.ty=x,d){var b=this.vertices,B=this.vertexIndex*this.vertSize,w=0,U=0,I=0,F=0,D=0,M=0,O=0;for(w=0,I=c.length;I>w;w+=2)U=5*w/2,M=d[w],O=d[w+1],F=c[w],D=c[w+1],b[B+U+0]=_*M+R*O+C,b[B+U+1]=L*M+A*O+S,b[B+U+2]=(r+F*a)/f,b[B+U+3]=(i+D*n)/l,b[B+U+4]=e;if(this.hasMesh)for(var N=0,P=p.length;P>N;++N)this.indicesForMesh[this.indexIndex+N]=p[N]+this.vertexIndex;this.vertexIndex+=c.length/2,this.indexIndex+=p.length}else{var $=f,G=l,V=a,X=n;r/=$,i/=G,a/=$,n/=G;var b=this.vertices,B=this.vertexIndex*this.vertSize;if(b[B++]=C,b[B++]=S,b[B++]=r,b[B++]=i,b[B++]=e,b[B++]=_*V+C,b[B++]=L*V+S,b[B++]=a+r,b[B++]=i,b[B++]=e,b[B++]=_*V+R*X+C,b[B++]=A*X+L*V+S,b[B++]=a+r,b[B++]=n+i,b[B++]=e,b[B++]=R*X+C,b[B++]=A*X+S,b[B++]=r,b[B++]=n+i,b[B++]=e,this.hasMesh){var H=this.indicesForMesh;H[this.indexIndex+0]=0+this.vertexIndex,H[this.indexIndex+1]=1+this.vertexIndex,H[this.indexIndex+2]=2+this.vertexIndex,H[this.indexIndex+3]=0+this.vertexIndex,H[this.indexIndex+4]=2+this.vertexIndex,H[this.indexIndex+5]=3+this.vertexIndex}this.vertexIndex+=4,this.indexIndex+=6}},t.prototype.cacheArraysForText=function(t,e,r,i,a){var n=t,s=n.a,o=n.b,h=n.c,u=n.d,f=n.tx,l=n.ty,c=n.a,d=n.b,p=n.c,v=n.d,y=n.tx-2,g=n.ty-2;n.a=s,n.b=o,n.c=h,n.d=u,n.tx=f,n.ty=l;for(var E=0,T=0,m=0;i>m;m++){var x=this.vertices,_=this.vertexIndex*this.vertSize,L=16*m;if(x[_++]=y+r[L++],x[_++]=g+r[L++],x[_++]=r[L++],x[_++]=r[L++],x[_++]=e,x[_++]=c*E+y+r[L++],x[_++]=d*E+g+r[L++],x[_++]=r[L++],x[_++]=r[L++],x[_++]=e,x[_++]=c*E+p*T+y+r[L++],x[_++]=v*T+d*E+g+r[L++],x[_++]=r[L++],x[_++]=r[L++],x[_++]=e,x[_++]=p*T+y+r[L++],x[_++]=v*T+g+r[L++],x[_++]=r[L++],x[_++]=r[L++],x[_++]=e,this.hasMesh){var R=this.indicesForMesh;R[this.indexIndex+0]=0+this.vertexIndex,R[this.indexIndex+1]=1+this.vertexIndex,R[this.indexIndex+2]=2+this.vertexIndex,R[this.indexIndex+3]=0+this.vertexIndex,R[this.indexIndex+4]=2+this.vertexIndex,R[this.indexIndex+5]=3+this.vertexIndex}this.vertexIndex+=4,this.indexIndex+=6}},t.prototype.clear=function(){this.hasMesh=!1,this.vertexIndex=0,this.indexIndex=0},t}();t.WebGLVertexArrayObject=e,__reflect(e.prototype,"egret.native2.WebGLVertexArrayObject")}(e=t.native2||(t.native2={}))}(egret||(egret={}));var egret;!function(t){var e;!function(t){var e=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.fragmentSrc="precision mediump float;uniform vec2 blur;uniform sampler2D uSampler;varying vec2 vTextureCoord;uniform vec2 uTextureSize;void main(){const int sampleRadius = 5;const int samples = sampleRadius * 2 + 1;vec2 blurUv = blur / uTextureSize;vec4 color = vec4(0, 0, 0, 0);vec2 uv = vec2(0.0, 0.0);blurUv /= float(sampleRadius);for (int i = -sampleRadius; i <= sampleRadius; i++) {uv.x = vTextureCoord.x + float(i) * blurUv.x;uv.y = vTextureCoord.y + float(i) * blurUv.y;color += texture2D(uSampler, uv);}color /= float(samples);gl_FragColor = color;}",e.uniforms={projectionVector:{type:"2f",value:{x:0,y:0},dirty:!0},blur:{type:"2f",value:{x:2,y:2},dirty:!0},uTextureSize:{type:"2f",value:{x:100,y:100},dirty:!0}},e}return __extends(e,t),e.prototype.setBlur=function(t,e){var r=this.uniforms.blur;(r.value.x!=t||r.value.y!=e)&&(r.value.x=t,r.value.y=e,r.dirty=!0)},e.prototype.setTextureSize=function(t,e){var r=this.uniforms.uTextureSize;(t!=r.value.x||e!=r.value.y)&&(r.value.x=t,r.value.y=e,r.dirty=!0)},e}(t.TextureShader);t.BlurShader=e,__reflect(e.prototype,"egret.native2.BlurShader")}(e=t.native2||(t.native2={}))}(egret||(egret={}));var egret;!function(t){var e;!function(t){var e=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.fragmentSrc="precision mediump float;\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nuniform mat4 matrix;\nuniform vec4 colorAdd;\nuniform sampler2D uSampler;\nvoid main(void) {\nvec4 texColor = texture2D(uSampler, vTextureCoord);\nif(texColor.a > 0.) {texColor = vec4(texColor.rgb / texColor.a, texColor.a);\n}vec4 locColor = clamp(texColor * matrix + colorAdd, 0., 1.);\ngl_FragColor = vColor * vec4(locColor.rgb * locColor.a, locColor.a);\n}",e.uniforms={projectionVector:{type:"2f",value:{x:0,y:0},dirty:!0},matrix:{type:"mat4",value:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],dirty:!0},colorAdd:{type:"4f",value:{x:0,y:0,z:0,w:0},dirty:!0}},e}return __extends(e,t),e.prototype.setMatrix=function(t){var e=this.uniforms.matrix;(e.value[0]!=t[0]||e.value[0]!=t[0]||e.value[1]!=t[1]||e.value[2]!=t[2]||e.value[3]!=t[3]||e.value[4]!=t[5]||e.value[5]!=t[6]||e.value[6]!=t[7]||e.value[7]!=t[8]||e.value[8]!=t[10]||e.value[9]!=t[11]||e.value[10]!=t[12]||e.value[11]!=t[13]||e.value[12]!=t[15]||e.value[13]!=t[16]||e.value[14]!=t[17]||e.value[15]!=t[18])&&(e.value[0]=t[0],e.value[1]=t[1],e.value[2]=t[2],e.value[3]=t[3],e.value[4]=t[5],e.value[5]=t[6],e.value[6]=t[7],e.value[7]=t[8],e.value[8]=t[10],e.value[9]=t[11],e.value[10]=t[12],e.value[11]=t[13],e.value[12]=t[15],e.value[13]=t[16],e.value[14]=t[17],e.value[15]=t[18],e.dirty=!0);var r=this.uniforms.colorAdd;(r.value.x!=t[4]/255||r.value.y!=t[9]/255||r.value.z!=t[14]/255||r.value.w!=t[19]/255)&&(r.value.x=t[4]/255,r.value.y=t[9]/255,r.value.z=t[14]/255,r.value.w=t[19]/255,r.dirty=!0)},e}(t.TextureShader);t.ColorTransformShader=e,__reflect(e.prototype,"egret.native2.ColorTransformShader")}(e=t.native2||(t.native2={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){var r=function(t){function e(){var e=t.call(this)||this;return e.$objType=0,e}return __extends(e,t),e}(t.HashObject);e.CmdCacheObject=r,__reflect(r.prototype,"egret.native2.CmdCacheObject");var i=function(){function t(t,e){this.maxArrayBufferLen=32e4,this.arrayBuffer=new ArrayBuffer(this.maxArrayBufferLen),this.dataView=new DataView(this.arrayBuffer),this.arrayBufferLen=0,this.DEPTH_BUFFER_BIT=256,this.STENCIL_BUFFER_BIT=1024,this.COLOR_BUFFER_BIT=16384,this.POINTS=0,this.LINES=1,this.LINE_LOOP=2,this.LINE_STRIP=3,this.TRIANGLES=4,this.TRIANGLE_STRIP=5,this.TRIANGLE_FAN=6,this.ZERO=0,this.ONE=1,this.SRC_COLOR=768,this.ONE_MINUS_SRC_COLOR=769,this.SRC_ALPHA=770,this.ONE_MINUS_SRC_ALPHA=771,this.DST_ALPHA=772,this.ONE_MINUS_DST_ALPHA=773,this.DST_COLOR=774,this.ONE_MINUS_DST_COLOR=775,this.SRC_ALPHA_SATURATE=776,this.FUNC_ADD=32774,this.BLEND_EQUATION=32777,this.BLEND_EQUATION_RGB=32777,this.BLEND_EQUATION_ALPHA=34877,this.FUNC_SUBTRACT=32778,this.FUNC_REVERSE_SUBTRACT=32779,this.BLEND_DST_RGB=32968,this.BLEND_SRC_RGB=32969,this.BLEND_DST_ALPHA=32970,this.BLEND_SRC_ALPHA=32971,this.CONSTANT_COLOR=32769,this.ONE_MINUS_CONSTANT_COLOR=32770,this.CONSTANT_ALPHA=32771,this.ONE_MINUS_CONSTANT_ALPHA=32772,this.BLEND_COLOR=32773,this.ARRAY_BUFFER=34962,this.ELEMENT_ARRAY_BUFFER=34963,this.ARRAY_BUFFER_BINDING=34964,this.ELEMENT_ARRAY_BUFFER_BINDING=34965,this.STREAM_DRAW=35040,this.STATIC_DRAW=35044,this.DYNAMIC_DRAW=35048,this.BUFFER_SIZE=34660,this.BUFFER_USAGE=34661,this.CURRENT_VERTEX_ATTRIB=34342,this.FRONT=1028,this.BACK=1029,this.FRONT_AND_BACK=1032,this.TEXTURE_2D=3553,this.CULL_FACE=2884,this.BLEND=3042,this.DITHER=3024,this.STENCIL_TEST=2960,this.DEPTH_TEST=2929,this.SCISSOR_TEST=3089,this.POLYGON_OFFSET_FILL=32823,this.SAMPLE_ALPHA_TO_COVERAGE=32926,this.SAMPLE_COVERAGE=32928,this.NO_ERROR=0,this.INVALID_ENUM=1280,this.INVALID_VALUE=1281,this.INVALID_OPERATION=1282,this.OUT_OF_MEMORY=1285,this.CW=2304,this.CCW=2305,this.LINE_WIDTH=2849,this.ALIASED_POINT_SIZE_RANGE=33901,this.ALIASED_LINE_WIDTH_RANGE=33902,this.CULL_FACE_MODE=2885,this.FRONT_FACE=2886,this.DEPTH_RANGE=2928,this.DEPTH_WRITEMASK=2930,this.DEPTH_CLEAR_VALUE=2931,this.DEPTH_FUNC=2932,this.STENCIL_CLEAR_VALUE=2961,this.STENCIL_FUNC=2962,this.STENCIL_FAIL=2964,this.STENCIL_PASS_DEPTH_FAIL=2965,this.STENCIL_PASS_DEPTH_PASS=2966,this.STENCIL_REF=2967,this.STENCIL_VALUE_MASK=2963,this.STENCIL_WRITEMASK=2968,this.STENCIL_BACK_FUNC=34816,this.STENCIL_BACK_FAIL=34817,this.STENCIL_BACK_PASS_DEPTH_FAIL=34818,this.STENCIL_BACK_PASS_DEPTH_PASS=34819,this.STENCIL_BACK_REF=36003,this.STENCIL_BACK_VALUE_MASK=36004,this.STENCIL_BACK_WRITEMASK=36005,this.VIEWPORT=2978,this.SCISSOR_BOX=3088,this.COLOR_CLEAR_VALUE=3106,this.COLOR_WRITEMASK=3107,this.UNPACK_ALIGNMENT=3317,this.PACK_ALIGNMENT=3333,this.MAX_TEXTURE_SIZE=3379,this.MAX_VIEWPORT_DIMS=3386,this.SUBPIXEL_BITS=3408,this.RED_BITS=3410,this.GREEN_BITS=3411,this.BLUE_BITS=3412,this.ALPHA_BITS=3413,this.DEPTH_BITS=3414,this.STENCIL_BITS=3415,this.POLYGON_OFFSET_UNITS=10752,this.POLYGON_OFFSET_FACTOR=32824,this.TEXTURE_BINDING_2D=32873,this.SAMPLE_BUFFERS=32936,this.SAMPLES=32937,this.SAMPLE_COVERAGE_VALUE=32938,this.SAMPLE_COVERAGE_INVERT=32939,this.COMPRESSED_TEXTURE_FORMATS=34467,this.DONT_CARE=4352,this.FASTEST=4353,this.NICEST=4354,this.GENERATE_MIPMAP_HINT=33170,this.BYTE=5120,this.UNSIGNED_BYTE=5121,this.SHORT=5122,this.UNSIGNED_SHORT=5123,this.INT=5124,this.UNSIGNED_INT=5125,this.FLOAT=5126,this.DEPTH_COMPONENT=6402,this.ALPHA=6406,this.RGB=6407,this.RGBA=6408,this.LUMINANCE=6409,this.LUMINANCE_ALPHA=6410,this.UNSIGNED_SHORT_4_4_4_4=32819,this.UNSIGNED_SHORT_5_5_5_1=32820,this.UNSIGNED_SHORT_5_6_5=33635,this.FRAGMENT_SHADER=35632,this.VERTEX_SHADER=35633,this.MAX_VERTEX_ATTRIBS=34921,this.MAX_VERTEX_UNIFORM_VECTORS=36347,this.MAX_VARYING_VECTORS=36348,this.MAX_COMBINED_TEXTURE_IMAGE_UNITS=35661,this.MAX_VERTEX_TEXTURE_IMAGE_UNITS=35660,this.MAX_TEXTURE_IMAGE_UNITS=34930,this.MAX_FRAGMENT_UNIFORM_VECTORS=36349,this.SHADER_TYPE=35663,this.DELETE_STATUS=35712,this.LINK_STATUS=35714,this.VALIDATE_STATUS=35715,this.ATTACHED_SHADERS=35717,this.ACTIVE_UNIFORMS=35718,this.ACTIVE_ATTRIBUTES=35721,this.SHADING_LANGUAGE_VERSION=35724,this.CURRENT_PROGRAM=35725,this.NEVER=512,this.LESS=513,this.EQUAL=514,this.LEQUAL=515,this.GREATER=516,this.NOTEQUAL=517,this.GEQUAL=518,this.ALWAYS=519,this.KEEP=7680,this.REPLACE=7681,this.INCR=7682,this.DECR=7683,this.INVERT=5386,this.INCR_WRAP=34055,this.DECR_WRAP=34056,this.VENDOR=7936,this.RENDERER=7937,this.VERSION=7938,this.NEAREST=9728,this.LINEAR=9729,this.NEAREST_MIPMAP_NEAREST=9984,this.LINEAR_MIPMAP_NEAREST=9985,this.NEAREST_MIPMAP_LINEAR=9986,this.LINEAR_MIPMAP_LINEAR=9987,this.TEXTURE_MAG_FILTER=10240,this.TEXTURE_MIN_FILTER=10241,this.TEXTURE_WRAP_S=10242,this.TEXTURE_WRAP_T=10243,this.TEXTURE=5890,this.TEXTURE_CUBE_MAP=34067,this.TEXTURE_BINDING_CUBE_MAP=34068,this.TEXTURE_CUBE_MAP_POSITIVE_X=34069,this.TEXTURE_CUBE_MAP_NEGATIVE_X=34070,this.TEXTURE_CUBE_MAP_POSITIVE_Y=34071,this.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072,this.TEXTURE_CUBE_MAP_POSITIVE_Z=34073,this.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074,this.MAX_CUBE_MAP_TEXTURE_SIZE=34076,this.TEXTURE0=33984,this.TEXTURE1=33985,this.TEXTURE2=33986,this.TEXTURE3=33987,this.TEXTURE4=33988,this.TEXTURE5=33989,this.TEXTURE6=33990,this.TEXTURE7=33991,this.TEXTURE8=33992,this.TEXTURE9=33993,this.TEXTURE10=33994,this.TEXTURE11=33995,this.TEXTURE12=33996,this.TEXTURE13=33997,this.TEXTURE14=33998,this.TEXTURE15=33999,this.TEXTURE16=34e3,this.TEXTURE17=34001,this.TEXTURE18=34002,this.TEXTURE19=34003,this.TEXTURE20=34004,this.TEXTURE21=34005,this.TEXTURE22=34006,this.TEXTURE23=34007,this.TEXTURE24=34008,this.TEXTURE25=34009,this.TEXTURE26=34010,this.TEXTURE27=34011,this.TEXTURE28=34012,this.TEXTURE29=34013,this.TEXTURE30=34014,this.TEXTURE31=34015,this.ACTIVE_TEXTURE=34016,this.REPEAT=10497,this.CLAMP_TO_EDGE=33071,this.MIRRORED_REPEAT=33648,this.FLOAT_VEC2=35664,this.FLOAT_VEC3=35665,this.FLOAT_VEC4=35666,this.INT_VEC2=35667,this.INT_VEC3=35668,this.INT_VEC4=35669,this.BOOL=35670,this.BOOL_VEC2=35671,this.BOOL_VEC3=35672,this.BOOL_VEC4=35673,this.FLOAT_MAT2=35674,this.FLOAT_MAT3=35675,this.FLOAT_MAT4=35676,this.SAMPLER_2D=35678,this.SAMPLER_CUBE=35680,this.VERTEX_ATTRIB_ARRAY_ENABLED=34338,this.VERTEX_ATTRIB_ARRAY_SIZE=34339,this.VERTEX_ATTRIB_ARRAY_STRIDE=34340,this.VERTEX_ATTRIB_ARRAY_TYPE=34341,this.VERTEX_ATTRIB_ARRAY_NORMALIZED=34922,this.VERTEX_ATTRIB_ARRAY_POINTER=34373,this.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING=34975,this.IMPLEMENTATION_COLOR_READ_TYPE=35738,this.IMPLEMENTATION_COLOR_READ_FORMAT=35739,this.COMPILE_STATUS=35713,this.LOW_FLOAT=36336,this.MEDIUM_FLOAT=36337,this.HIGH_FLOAT=36338,this.LOW_INT=36339,this.MEDIUM_INT=36340,this.HIGH_INT=36341,this.FRAMEBUFFER=36160,this.RENDERBUFFER=36161,this.RGBA4=32854,this.RGB5_A1=32855,this.RGB565=36194,this.DEPTH_COMPONENT16=33189,this.STENCIL_INDEX=6401,this.STENCIL_INDEX8=36168,this.DEPTH_STENCIL=34041,this.RENDERBUFFER_WIDTH=36162,this.RENDERBUFFER_HEIGHT=36163,this.RENDERBUFFER_INTERNAL_FORMAT=36164,this.RENDERBUFFER_RED_SIZE=36176,this.RENDERBUFFER_GREEN_SIZE=36177,this.RENDERBUFFER_BLUE_SIZE=36178,this.RENDERBUFFER_ALPHA_SIZE=36179,this.RENDERBUFFER_DEPTH_SIZE=36180,this.RENDERBUFFER_STENCIL_SIZE=36181,this.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE=36048,this.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME=36049,this.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL=36050,this.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE=36051,this.COLOR_ATTACHMENT0=36064,this.DEPTH_ATTACHMENT=36096,this.STENCIL_ATTACHMENT=36128,this.DEPTH_STENCIL_ATTACHMENT=33306,this.NONE=0,this.FRAMEBUFFER_COMPLETE=36053,this.FRAMEBUFFER_INCOMPLETE_ATTACHMENT=36054,this.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT=36055,this.FRAMEBUFFER_INCOMPLETE_DIMENSIONS=36057,this.FRAMEBUFFER_UNSUPPORTED=36061,this.FRAMEBUFFER_BINDING=36006,this.RENDERBUFFER_BINDING=36007,this.MAX_RENDERBUFFER_SIZE=34024,this.INVALID_FRAMEBUFFER_OPERATION=1286,this.UNPACK_FLIP_Y_WEBGL=37440,this.UNPACK_PREMULTIPLY_ALPHA_WEBGL=37441,this.CONTEXT_LOST_WEBGL=37442,this.UNPACK_COLORSPACE_CONVERSION_WEBGL=37443,this.BROWSER_DEFAULT_WEBGL=37444,this.strArray=new Array,this.typedArrays=new Array,this._canvas=t,this._glContext=e}return t.prototype.initCacheContext=function(){var t=this;egret_native.Label.bindTexture=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];t.bindLabelTexture.apply(t,e)}},t.prototype.flushCmd=function(){var t=this._canvas.sendGLArray;t&&this._canvas.sendGLArray(this.dataView.buffer,this.arrayBufferLen,this.strArray,this.typedArrays),this.arrayBufferLen=0,this.strArray.length=0,this.typedArrays.length=0},t.prototype.pushString=function(t){var e=this.strArray,r=e.length;return e[r]=t,r},t.prototype.pushTypedArrays=function(t){var e=this.typedArrays,r=e.length;return e[r]=t,r},t.prototype.clear=function(t){this.arrayBufferLen+8>this.maxArrayBufferLen&&this.flushCmd();var e=this.dataView,r=this.arrayBufferLen;e.setUint32(r,41,!0),r+=4,e.setUint32(r,t,!0),r+=4,this.arrayBufferLen=r},t.prototype.enable=function(t){this.arrayBufferLen+8>this.maxArrayBufferLen&&this.flushCmd();var e=this.dataView,r=this.arrayBufferLen;e.setUint32(r,72,!0),r+=4,e.setUint32(r,t,!0),r+=4,this.arrayBufferLen=r
},t.prototype.disable=function(t){this.arrayBufferLen+8>this.maxArrayBufferLen&&this.flushCmd();var e=this.dataView,r=this.arrayBufferLen;e.setUint32(r,68,!0),r+=4,e.setUint32(r,t,!0),r+=4,this.arrayBufferLen=r},t.prototype.disableVertexAttribArray=function(t){if("number"==typeof t)return void this._glContext.disableVertexAttribArray(t);this.arrayBufferLen+8>this.maxArrayBufferLen&&this.flushCmd();var e=this.dataView,r=this.arrayBufferLen;e.setUint32(r,69,!0),r+=4,e.setUint32(r,t.hashCode,!0),r+=4,this.arrayBufferLen=r},t.prototype.scissor=function(t,e,r,i){this.arrayBufferLen+20>this.maxArrayBufferLen&&this.flushCmd();var a=this.dataView,n=this.arrayBufferLen;a.setUint32(n,119,!0),n+=4,a.setInt32(n,t,!0),n+=4,a.setInt32(n,e,!0),n+=4,a.setInt32(n,r,!0),n+=4,a.setInt32(n,i,!0),n+=4,this.arrayBufferLen=n},t.prototype.readPixels=function(t,e,r,i,a,n,s){},t.prototype.renderbufferStorage=function(t,e,r,i){this.arrayBufferLen+20>this.maxArrayBufferLen&&this.flushCmd();var a=this.dataView,n=this.arrayBufferLen;a.setUint32(n,117,!0),n+=4,a.setUint32(n,t,!0),n+=4,a.setUint32(n,e,!0),n+=4,a.setInt32(n,r,!0),n+=4,a.setInt32(n,i,!0),n+=4,this.arrayBufferLen=n},t.prototype.framebufferRenderbuffer=function(t,e,r,i){this.arrayBufferLen+20>this.maxArrayBufferLen&&this.flushCmd();var a=this.dataView,n=this.arrayBufferLen;a.setUint32(n,76,!0),n+=4,a.setUint32(n,t,!0),n+=4,a.setUint32(n,e,!0),n+=4,a.setUint32(n,r,!0),n+=4,a.setUint32(n,i.hashCode,!0),n+=4,this.arrayBufferLen=n},t.prototype.framebufferTexture2D=function(t,e,r,i,a){this.arrayBufferLen+24>this.maxArrayBufferLen&&this.flushCmd();var n=this.dataView,s=this.arrayBufferLen;n.setUint32(s,77,!0),s+=4,n.setUint32(s,t,!0),s+=4,n.setUint32(s,e,!0),s+=4,n.setUint32(s,r,!0),s+=4,n.setUint32(s,i.hashCode,!0),s+=4,n.setInt32(s,a,!0),s+=4,this.arrayBufferLen=s},t.prototype.blendFunc=function(t,e){this.arrayBufferLen+12>this.maxArrayBufferLen&&this.flushCmd();var r=this.dataView,i=this.arrayBufferLen;r.setUint32(i,36,!0),i+=4,r.setUint32(i,t,!0),i+=4,r.setUint32(i,e,!0),i+=4,this.arrayBufferLen=i},t.prototype.finish=function(){this.arrayBufferLen+4>this.maxArrayBufferLen&&this.flushCmd();var t=this.dataView,e=this.arrayBufferLen;t.setUint32(e,74,!0),e+=4,this.arrayBufferLen=e},t.prototype.flush=function(){this.arrayBufferLen+4>this.maxArrayBufferLen&&this.flushCmd();var t=this.dataView,e=this.arrayBufferLen;t.setUint32(e,75,!0),e+=4,this.arrayBufferLen=e},t.prototype.clearColor=function(t,e,r,i){this.arrayBufferLen+20>this.maxArrayBufferLen&&this.flushCmd();var a=this.dataView,n=this.arrayBufferLen;a.setUint32(n,42,!0),n+=4,a.setFloat32(n,t,!0),n+=4,a.setFloat32(n,e,!0),n+=4,a.setFloat32(n,r,!0),n+=4,a.setFloat32(n,i,!0),n+=4,this.arrayBufferLen=n},t.prototype.colorMask=function(t,e,r,i){this.arrayBufferLen+20>this.maxArrayBufferLen&&this.flushCmd();var a=this.dataView,n=this.arrayBufferLen;a.setUint32(n,45,!0),n+=4,a.setUint32(n,t?1:0,!0),n+=4,a.setUint32(n,e?1:0,!0),n+=4,a.setUint32(n,r?1:0,!0),n+=4,a.setUint32(n,i?1:0,!0),n+=4,this.arrayBufferLen=n},t.prototype.viewport=function(t,e,r,i){this.arrayBufferLen+20>this.maxArrayBufferLen&&this.flushCmd();var a=this.dataView,n=this.arrayBufferLen;a.setUint32(n,163,!0),n+=4,a.setInt32(n,t,!0),n+=4,a.setInt32(n,e,!0),n+=4,a.setInt32(n,r,!0),n+=4,a.setInt32(n,i,!0),n+=4,this.arrayBufferLen=n},t.prototype.createBuffer=function(){this.arrayBufferLen+8>this.maxArrayBufferLen&&this.flushCmd();var t=this.dataView,e=this.arrayBufferLen,i=new r;return i.$objType=2,t.setUint32(e,51,!0),e+=4,t.setUint32(e,i.hashCode,!0),e+=4,this.arrayBufferLen=e,i},t.prototype.createFramebuffer=function(){this.arrayBufferLen+8>this.maxArrayBufferLen&&this.flushCmd();var t=this.dataView,e=this.arrayBufferLen,i=new r;return i.$objType=3,t.setUint32(e,52,!0),e+=4,t.setUint32(e,i.hashCode,!0),e+=4,this.arrayBufferLen=e,i},t.prototype.createRenderbuffer=function(){this.arrayBufferLen+8>this.maxArrayBufferLen&&this.flushCmd();var t=this.dataView,e=this.arrayBufferLen,i=new r;return i.$objType=5,t.setUint32(e,54,!0),e+=4,t.setUint32(e,i.hashCode,!0),e+=4,this.arrayBufferLen=e,i},t.prototype.bindBuffer=function(t,e){this.arrayBufferLen+12>this.maxArrayBufferLen&&this.flushCmd();var r=this.dataView,i=this.arrayBufferLen;r.setUint32(i,29,!0),i+=4,r.setUint32(i,t,!0),i+=4,r.setUint32(i,e.hashCode,!0),i+=4,this.arrayBufferLen=i},t.prototype.bindFramebuffer=function(t,e){this.arrayBufferLen+12>this.maxArrayBufferLen&&this.flushCmd();var r=this.dataView,i=this.arrayBufferLen;r.setUint32(i,30,!0),i+=4,r.setUint32(i,t,!0),i+=4,null==e?r.setUint32(i,4294967295,!0):r.setUint32(i,e.hashCode,!0),i+=4,this.arrayBufferLen=i},t.prototype.bindRenderbuffer=function(t,e){this.arrayBufferLen+12>this.maxArrayBufferLen&&this.flushCmd();var r=this.dataView,i=this.arrayBufferLen;r.setUint32(i,31,!0),i+=4,r.setUint32(i,t,!0),i+=4,null==e||0==e.hashCode?r.setUint32(i,0,!0):r.setUint32(i,e.hashCode,!0),i+=4,this.arrayBufferLen=i},t.prototype.createProgram=function(){this.arrayBufferLen+8>this.maxArrayBufferLen&&this.flushCmd();var t=this.dataView,e=this.arrayBufferLen,i=new r;return i.$objType=4,t.setUint32(e,53,!0),e+=4,t.setUint32(e,i.hashCode,!0),e+=4,this.arrayBufferLen=e,i},t.prototype.useProgram=function(t){this.arrayBufferLen+8>this.maxArrayBufferLen&&this.flushCmd();var e=this.dataView,r=this.arrayBufferLen;e.setUint32(r,152,!0),r+=4,e.setUint32(r,t.hashCode,!0),r+=4,this.arrayBufferLen=r},t.prototype.createShader=function(t){this.arrayBufferLen+12>this.maxArrayBufferLen&&this.flushCmd();var e=this.dataView,i=this.arrayBufferLen,a=new r;return a.$objType=6,e.setUint32(i,55,!0),i+=4,e.setUint32(i,a.hashCode,!0),i+=4,e.setUint32(i,t,!0),i+=4,this.arrayBufferLen=i,a},t.prototype.compileShader=function(t){this.arrayBufferLen+8>this.maxArrayBufferLen&&this.flushCmd();var e=this.dataView,r=this.arrayBufferLen;e.setUint32(r,46,!0),r+=4,e.setUint32(r,t.hashCode,!0),r+=4,this.arrayBufferLen=r},t.prototype.shaderSource=function(t,e){this.arrayBufferLen+12>this.maxArrayBufferLen&&this.flushCmd();var r=this.dataView,i=this.arrayBufferLen,a=this.pushString(e);r.setUint32(i,96,!0),i+=4,r.setUint32(i,t.hashCode,!0),i+=4,r.setUint32(i,a,!0),i+=4,this.arrayBufferLen=i},t.prototype.getShaderParameter=function(t,e){return 1},t.prototype.getProgramParameter=function(t,e){return 1},t.prototype.getShaderInfoLog=function(){return"TODO - getShaderInfoLog"},t.prototype.attachShader=function(t,e){this.arrayBufferLen+12>this.maxArrayBufferLen&&this.flushCmd();var r=this.dataView,i=this.arrayBufferLen;r.setUint32(i,27,!0),i+=4,r.setUint32(i,t.hashCode,!0),i+=4,r.setUint32(i,e.hashCode,!0),i+=4,this.arrayBufferLen=i},t.prototype.linkProgram=function(t){this.arrayBufferLen+8>this.maxArrayBufferLen&&this.flushCmd();var e=this.dataView,r=this.arrayBufferLen;e.setUint32(r,113,!0),r+=4,e.setUint32(r,t.hashCode,!0),r+=4,this.arrayBufferLen=r},t.prototype.pixelStorei=function(t,e){this.arrayBufferLen+12>this.maxArrayBufferLen&&this.flushCmd();var r=this.dataView,i=this.arrayBufferLen;r.setUint32(i,114,!0),i+=4,r.setUint32(i,t,!0),i+=4,r.setInt32(i,e,!0),i+=4,this.arrayBufferLen=i},t.prototype.createTexture=function(){this.arrayBufferLen+8>this.maxArrayBufferLen&&this.flushCmd();var t=this.dataView,e=this.arrayBufferLen,i=new r;return i.$objType=7,t.setUint32(e,56,!0),e+=4,t.setUint32(e,i.hashCode,!0),e+=4,this.arrayBufferLen=e,i},t.prototype.deleteBuffer=function(t){if(!(null==t||t.hashCode<=0)){this.arrayBufferLen+8>this.maxArrayBufferLen&&this.flushCmd();var e=this.dataView,r=this.arrayBufferLen;e.setUint32(r,58,!0),r+=4,e.setUint32(r,t.hashCode,!0),r+=4,this.arrayBufferLen=r}},t.prototype.deleteFramebuffer=function(t){if(!(null==t||t.hashCode<=0)){this.arrayBufferLen+8>this.maxArrayBufferLen&&this.flushCmd();var e=this.dataView,r=this.arrayBufferLen;e.setUint32(r,59,!0),r+=4,e.setUint32(r,t.hashCode,!0),r+=4,this.arrayBufferLen=r}},t.prototype.deleteProgram=function(t){if(!(null==t||t.hashCode<=0)){this.arrayBufferLen+8>this.maxArrayBufferLen&&this.flushCmd();var e=this.dataView,r=this.arrayBufferLen;e.setUint32(r,60,!0),r+=4,e.setUint32(r,t.hashCode,!0),r+=4,this.arrayBufferLen=r}},t.prototype.deleteRenderbuffer=function(t){if(!(null==t||t.hashCode<=0)){this.arrayBufferLen+8>this.maxArrayBufferLen&&this.flushCmd();var e=this.dataView,r=this.arrayBufferLen;e.setUint32(r,61,!0),r+=4,e.setUint32(r,t.hashCode,!0),r+=4,this.arrayBufferLen=r}},t.prototype.deleteShader=function(t){if(!(null==t||t.hashCode<=0)){this.arrayBufferLen+8>this.maxArrayBufferLen&&this.flushCmd();var e=this.dataView,r=this.arrayBufferLen;e.setUint32(r,62,!0),r+=4,e.setUint32(r,t.hashCode,!0),r+=4,this.arrayBufferLen=r}},t.prototype.deleteTexture=function(t){if(!(null==t||t.hashCode<=0)){this.arrayBufferLen+8>this.maxArrayBufferLen&&this.flushCmd();var e=this.dataView,r=this.arrayBufferLen;e.setUint32(r,63,!0),r+=4,e.setUint32(r,t.hashCode,!0),r+=4,this.arrayBufferLen=r}},t.prototype.activeTexture=function(t){this.arrayBufferLen+8>this.maxArrayBufferLen&&this.flushCmd();var e=this.dataView,r=this.arrayBufferLen;e.setUint32(r,26,!0),r+=4,e.setUint32(r,t,!0),r+=4,this.arrayBufferLen=r},t.prototype.bindTexture=function(t,e){this.arrayBufferLen+12>this.maxArrayBufferLen&&this.flushCmd();var r=this.dataView,i=this.arrayBufferLen;r.setUint32(i,32,!0),i+=4,r.setUint32(i,t,!0),i+=4,null==e?r.setUint32(i,4294967295,!0):r.setUint32(i,e.hashCode,!0),i+=4,this.arrayBufferLen=i},t.prototype.getUniformLocation=function(t,e){if(null!=t){this.arrayBufferLen+16>this.maxArrayBufferLen&&this.flushCmd();var i=this.dataView,a=this.arrayBufferLen;i.setUint32(a,100,!0),a+=4,i.setUint32(a,t.hashCode,!0),a+=4;var n=this.pushString(e);i.setUint32(a,n,!0),a+=4;var s=new r;return s.$objType=8,i.setUint32(a,s.hashCode,!0),a+=4,this.arrayBufferLen=a,s}},t.prototype.getAttribLocation=function(t,e){this.arrayBufferLen+16>this.maxArrayBufferLen&&this.flushCmd();var i=this.dataView,a=this.arrayBufferLen;i.setUint32(a,83,!0),a+=4,i.setUint32(a,t.hashCode,!0),a+=4;var n=this.pushString(e);i.setUint32(a,n,!0),a+=4;var s=new r;return s.$objType=16,i.setUint32(a,s.hashCode,!0),a+=4,this.arrayBufferLen=a,s},t.prototype.getActiveAttrib=function(t,e){},t.prototype.getVertexAttrib=function(t,e){},t.prototype.enableVertexAttribArray=function(t){if("number"==typeof t)return void this._glContext.enableVertexAttribArray(t);this.arrayBufferLen+8>this.maxArrayBufferLen&&this.flushCmd();var e=this.dataView,r=this.arrayBufferLen;e.setUint32(r,73,!0),r+=4,e.setUint32(r,t.hashCode,!0),r+=4,this.arrayBufferLen=r},t.prototype.vertexAttrib4fv=function(t,e){this.arrayBufferLen+12>this.maxArrayBufferLen&&this.flushCmd();var r=this.dataView,i=this.arrayBufferLen;r.setUint32(i,161,!0),i+=4,r.setUint32(i,t.hashCode,!0),i+=4;var a=this.pushTypedArrays(e);r.setUint32(i,a,!0),i+=4,this.arrayBufferLen=i},t.prototype.vertexAttribPointer=function(t,e,r,i,a,n){this.arrayBufferLen+28>this.maxArrayBufferLen&&this.flushCmd();var s=this.dataView,o=this.arrayBufferLen;s.setUint32(o,162,!0),o+=4,s.setUint32(o,t.hashCode,!0),o+=4,s.setUint32(o,e,!0),o+=4,s.setUint32(o,r,!0),o+=4,s.setUint32(o,i?1:0,!0),o+=4,s.setUint32(o,a,!0),o+=4,s.setUint32(o,n,!0),o+=4,this.arrayBufferLen=o},t.prototype.uniformxv=function(t,e,r){this.arrayBufferLen+12>this.maxArrayBufferLen&&this.flushCmd();var i=this.dataView,a=this.arrayBufferLen;i.setUint32(a,r,!0),a+=4,i.setUint32(a,t.hashCode,!0);var n=this.pushTypedArrays(e);a+=4,i.setUint32(a,n,!0),a+=4,this.arrayBufferLen=a},t.prototype.uniform1iv=function(t,e){this.uniformxv(t,e,136)},t.prototype.uniform2iv=function(t,e){this.uniformxv(t,e,140)},t.prototype.uniform3iv=function(t,e){this.uniformxv(t,e,144)},t.prototype.uniform4iv=function(t,e){this.uniformxv(t,e,148)},t.prototype.uniform1fv=function(t,e){this.uniformxv(t,e,134)},t.prototype.uniform2fv=function(t,e){this.uniformxv(t,e,138)},t.prototype.uniform3fv=function(t,e){this.uniformxv(t,e,142)},t.prototype.uniform4fv=function(t,e){this.uniformxv(t,e,146)},t.prototype.uniform1f=function(t,e){this.arrayBufferLen+12>this.maxArrayBufferLen&&this.flushCmd();var r=this.dataView,i=this.arrayBufferLen;r.setUint32(i,133,!0),i+=4,r.setUint32(i,t.hashCode,!0),i+=4,r.setFloat32(i,e,!0),i+=4,this.arrayBufferLen=i},t.prototype.uniform1i=function(t,e){this.arrayBufferLen+12>this.maxArrayBufferLen&&this.flushCmd();var r=this.dataView,i=this.arrayBufferLen;r.setUint32(i,135,!0),i+=4,r.setUint32(i,t.hashCode,!0),i+=4,r.setInt32(i,e,!0),i+=4,this.arrayBufferLen=i},t.prototype.uniform2f=function(t,e,r){this.arrayBufferLen+16>this.maxArrayBufferLen&&this.flushCmd();var i=this.dataView,a=this.arrayBufferLen;i.setUint32(a,137,!0),a+=4,i.setUint32(a,t.hashCode,!0),a+=4,i.setFloat32(a,e,!0),a+=4,i.setFloat32(a,r,!0),a+=4,this.arrayBufferLen=a},t.prototype.uniform2i=function(t,e,r){this.arrayBufferLen+16>this.maxArrayBufferLen&&this.flushCmd();var i=this.dataView,a=this.arrayBufferLen;i.setUint32(a,139,!0),a+=4,i.setUint32(a,t.hashCode,!0),a+=4,i.setInt32(a,e,!0),a+=4,i.setInt32(a,r,!0),a+=4,this.arrayBufferLen=a},t.prototype.uniform3f=function(t,e,r,i){this.arrayBufferLen+20>this.maxArrayBufferLen&&this.flushCmd();var a=this.dataView,n=this.arrayBufferLen;a.setUint32(n,141,!0),n+=4,a.setUint32(n,t.hashCode,!0),n+=4,a.setFloat32(n,e,!0),n+=4,a.setFloat32(n,r,!0),n+=4,a.setFloat32(n,i,!0),n+=4,this.arrayBufferLen=n},t.prototype.uniform3i=function(t,e,r,i){this.arrayBufferLen+20>this.maxArrayBufferLen&&this.flushCmd();var a=this.dataView,n=this.arrayBufferLen;a.setUint32(n,143,!0),n+=4,a.setUint32(n,t.hashCode,!0),n+=4,a.setInt32(n,e,!0),n+=4,a.setInt32(n,r,!0),n+=4,a.setInt32(n,i,!0),n+=4,this.arrayBufferLen=n},t.prototype.uniform4f=function(t,e,r,i,a){this.arrayBufferLen+24>this.maxArrayBufferLen&&this.flushCmd();var n=this.dataView,s=this.arrayBufferLen;n.setUint32(s,145,!0),s+=4,n.setUint32(s,t.hashCode,!0),s+=4,n.setFloat32(s,e,!0),s+=4,n.setFloat32(s,r,!0),s+=4,n.setFloat32(s,i,!0),s+=4,n.setFloat32(s,a,!0),s+=4,this.arrayBufferLen=s},t.prototype.uniform4i=function(t,e,r,i,a){this.arrayBufferLen+24>this.maxArrayBufferLen&&this.flushCmd();var n=this.dataView,s=this.arrayBufferLen;n.setUint32(s,147,!0),s+=4,n.setUint32(s,t.hashCode,!0),s+=4,n.setInt32(s,e,!0),s+=4,n.setInt32(s,r,!0),s+=4,n.setInt32(s,i,!0),s+=4,n.setInt32(s,a,!0),s+=4,this.arrayBufferLen=s},t.prototype.uniformMatrix2fv=function(t,e,r){this.arrayBufferLen+16>this.maxArrayBufferLen&&this.flushCmd();var i=this.dataView,a=this.arrayBufferLen;i.setUint32(a,149,!0),a+=4,i.setUint32(a,t.hashCode,!0),a+=4,i.setUint32(a,e?1:0,!0),a+=4;var n=0;if(r instanceof Array){var s=new Float32Array(r);n=this.pushTypedArrays(s)}else n=this.pushTypedArrays(r);i.setUint32(a,n,!0),a+=4,this.arrayBufferLen=a},t.prototype.uniformMatrix3fv=function(t,e,r){this.arrayBufferLen+16>this.maxArrayBufferLen&&this.flushCmd();var i=this.dataView,a=this.arrayBufferLen;i.setUint32(a,150,!0),a+=4,i.setUint32(a,t.hashCode,!0),a+=4,i.setUint32(a,e?1:0,!0),a+=4;var n=0;if(r instanceof Array){var s=new Float32Array(r);n=this.pushTypedArrays(s)}else n=this.pushTypedArrays(r);i.setUint32(a,n,!0),a+=4,this.arrayBufferLen=a},t.prototype.uniformMatrix4fv=function(t,e,r){if(null==r||void 0==r)return void console.log("js warning uniformMatrix4fv");this.arrayBufferLen+16>this.maxArrayBufferLen&&this.flushCmd();var i=this.dataView,a=this.arrayBufferLen;i.setUint32(a,151,!0),a+=4,i.setUint32(a,t.hashCode,!0),a+=4,i.setUint32(a,e?1:0,!0),a+=4;var n=0;if(r instanceof Array){var s=new Float32Array(r);n=this.pushTypedArrays(s)}else n=this.pushTypedArrays(r);i.setUint32(a,n,!0),a+=4,this.arrayBufferLen=a},t.prototype.texImage2Di=function(t,e,r,i,a,n,s,o,h){this.arrayBufferLen+40>this.maxArrayBufferLen&&this.flushCmd();var u=this.dataView,f=this.arrayBufferLen;if(u.setUint32(f,127,!0),f+=4,u.setUint32(f,t,!0),f+=4,u.setUint32(f,e,!0),f+=4,u.setUint32(f,r,!0),f+=4,u.setInt32(f,i,!0),f+=4,u.setInt32(f,a,!0),f+=4,u.setInt32(f,n,!0),f+=4,u.setUint32(f,s,!0),f+=4,u.setUint32(f,o,!0),f+=4,null==h)u.setUint32(f,4294967295,!0);else{var l=this.pushTypedArrays(h);u.setUint32(f,l,!0)}f+=4,this.arrayBufferLen=f},t.prototype.texImage2D=function(t,e,r,i,a,n){if(9==arguments.length)return void this.texImage2Di(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5],arguments[6],arguments[7],arguments[8]);this.arrayBufferLen+32>this.maxArrayBufferLen&&this.flushCmd();var s=this.dataView,o=this.arrayBufferLen;if(s.setUint32(o,128,!0),o+=4,s.setUint32(o,t,!0),o+=4,s.setUint32(o,e,!0),o+=4,s.setUint32(o,r,!0),o+=4,s.setUint32(o,i,!0),o+=4,s.setUint32(o,a,!0),o+=4,null==n)return s.setUint32(o,0,!0),o+=4,s.setUint32(o,0,!0),o+=4,void(this.arrayBufferLen=o);var h=n.___native_p__?n.___native_p__:n.source.___native_p__;h?(s.setUint32(o,h/4294967296>>>0,!0),o+=4,s.setUint32(o,(4294967295&h)>>>0,!0),o+=4):console.log("js error pixels ="+n+".format ="+n.format),this.arrayBufferLen=o},t.prototype.compressedTexImage2D=function(t,e,r,i,a,n,s){this.arrayBufferLen+32>this.maxArrayBufferLen&&this.flushCmd();var o=this.dataView,h=this.arrayBufferLen;if(o.setUint32(h,47,!0),h+=4,o.setUint32(h,t,!0),h+=4,o.setUint32(h,e,!0),h+=4,o.setUint32(h,r,!0),h+=4,o.setInt32(h,i,!0),h+=4,o.setInt32(h,a,!0),h+=4,o.setInt32(h,n,!0),h+=4,null==s)o.setUint32(h,4294967295,!0);else{var u=this.pushTypedArrays(s);o.setUint32(h,u,!0)}h+=4,this.arrayBufferLen=h},t.prototype.cullFace=function(t){this.arrayBufferLen+8>this.maxArrayBufferLen&&this.flushCmd();var e=this.dataView,r=this.arrayBufferLen;e.setUint32(r,57,!0),r+=4,e.setUint32(r,t,!0),r+=4,this.arrayBufferLen=r},t.prototype.depthFunc=function(t){this.arrayBufferLen+8>this.maxArrayBufferLen&&this.flushCmd();var e=this.dataView,r=this.arrayBufferLen;e.setUint32(r,64,!0),r+=4,e.setUint32(r,t,!0),r+=4,this.arrayBufferLen=r},t.prototype.depthMask=function(t){this.arrayBufferLen+8>this.maxArrayBufferLen&&this.flushCmd();var e=this.dataView,r=this.arrayBufferLen;e.setUint32(r,65,!0),r+=4,e.setUint32(r,t?1:0,!0),r+=4,this.arrayBufferLen=r},t.prototype.depthRange=function(t,e){this.arrayBufferLen+12>this.maxArrayBufferLen&&this.flushCmd();var r=this.dataView,i=this.arrayBufferLen;r.setUint32(i,66,!0),i+=4,r.setFloat32(i,t,!0),i+=4,r.setFloat32(i,e,!0),i+=4,this.arrayBufferLen=i},t.prototype.texParameterf=function(t,e,r){this.arrayBufferLen+16>this.maxArrayBufferLen&&this.flushCmd();var i=this.dataView,a=this.arrayBufferLen;i.setUint32(a,129,!0),a+=4,i.setUint32(a,t,!0),a+=4,i.setUint32(a,e,!0),a+=4,i.setFloat32(a,r,!0),a+=4,this.arrayBufferLen=a},t.prototype.texParameteri=function(t,e,r){this.arrayBufferLen+16>this.maxArrayBufferLen&&this.flushCmd();var i=this.dataView,a=this.arrayBufferLen;i.setUint32(a,130,!0),a+=4,i.setUint32(a,t,!0),a+=4,i.setUint32(a,e,!0),a+=4,i.setInt32(a,r,!0),a+=4,this.arrayBufferLen=a},t.prototype.generateMipmap=function(t){this.arrayBufferLen+8>this.maxArrayBufferLen&&this.flushCmd();var e=this.dataView,r=this.arrayBufferLen;e.setUint32(r,79,!0),r+=4,e.setUint32(r,t,!0),r+=4,this.arrayBufferLen=r},t.prototype.bufferData=function(t,e,r){this.arrayBufferLen+16>this.maxArrayBufferLen&&this.flushCmd();var i=this.dataView,a=this.arrayBufferLen;if(i.setUint32(a,38,!0),a+=4,i.setUint32(a,t,!0),a+=4,e){var n=this.pushTypedArrays(e);i.setUint32(a,n,!0),a+=4}i.setUint32(a,r,!0),a+=4,this.arrayBufferLen=a},t.prototype.bufferSubData=function(t,e,r){this.arrayBufferLen+16>this.maxArrayBufferLen&&this.flushCmd();var i=this.dataView,a=this.arrayBufferLen;if(i.setUint32(a,39,!0),a+=4,i.setUint32(a,t,!0),a+=4,i.setUint32(a,e,!0),a+=4,r.byteLength){var n=this.pushTypedArrays(r);i.setUint32(a,n,!0),a+=4}this.arrayBufferLen=a},t.prototype.drawArrays=function(t,e,r){this.arrayBufferLen+16>this.maxArrayBufferLen&&this.flushCmd();var i=this.dataView,a=this.arrayBufferLen;i.setUint32(a,70,!0),a+=4,i.setUint32(a,t,!0),a+=4,i.setUint32(a,e,!0),a+=4,i.setUint32(a,r,!0),a+=4,this.arrayBufferLen=a},t.prototype.drawElements=function(t,e,r,i){this.arrayBufferLen+20>this.maxArrayBufferLen&&this.flushCmd();var a=this.dataView,n=this.arrayBufferLen;a.setUint32(n,71,!0),n+=4,a.setUint32(n,t,!0),n+=4,a.setUint32(n,e,!0),n+=4,a.setUint32(n,r,!0),n+=4,a.setUint32(n,i,!0),n+=4,this.arrayBufferLen=n},t.prototype.drawText=function(t,e,r,i,a){this.arrayBufferLen+24>this.maxArrayBufferLen&&this.flushCmd();var n=this.dataView,s=this.arrayBufferLen;n.setUint32(s,255,!0),s+=4;var o=this.pushString(t);n.setUint32(s,o,!0),s+=4;var h=this.pushTypedArrays(e);n.setUint32(s,h,!0),s+=4,n.setUint32(s,r,!0),s+=4,n.setUint32(s,i?1:0,!0),s+=4,n.setUint32(s,a,!0),s+=4,this.arrayBufferLen=s},t.prototype.bindLabelTexture=function(t,e){this.arrayBufferLen+16>this.maxArrayBufferLen&&this.flushCmd();var r=this.dataView,i=this.arrayBufferLen;r.setUint32(i,254,!0),i+=4,r.setUint32(i,t/4294967296>>>0,!0),i+=4,r.setUint32(i,(4294967295&t)>>>0,!0),i+=4,r.setInt32(i,e,!0),i+=4,this.arrayBufferLen=i},t.prototype.getExtension=function(t){return this._glContext.getExtension(t)},t}();i.SIZE_OF_UINT16=2,i.SIZE_OF_UINT32=4,i.SIZE_OF_FLOAT32=4,e.WebGLCmdArrayManager=i,__reflect(i.prototype,"egret.native2.WebGLCmdArrayManager")}(e=t.native2||(t.native2={}))}(egret||(egret={}));var egret;!function(t){var e;!function(t){var e=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.fragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","uniform sampler2D uSampler;","uniform float dist;","uniform float angle;","uniform vec4 color;","uniform float alpha;","uniform float blurX;","uniform float blurY;","uniform float strength;","uniform float inner;","uniform float knockout;","uniform float hideObject;","uniform vec2 uTextureSize;float random(vec3 scale, float seed)","{","return fract(sin(dot(gl_FragCoord.xyz + seed, scale)) * 43758.5453 + seed);","}","void main(void) {","vec2 px = vec2(1.0 / uTextureSize.x, 1.0 / uTextureSize.y);","const float linearSamplingTimes = 7.0;","const float circleSamplingTimes = 12.0;","vec4 ownColor = texture2D(uSampler, vTextureCoord);","vec4 curColor;","float totalAlpha = 0.0;","float maxTotalAlpha = 0.0;","float curDistanceX = 0.0;","float curDistanceY = 0.0;","float offsetX = dist * cos(angle) * px.x;","float offsetY = dist * sin(angle) * px.y;","const float PI = 3.14159265358979323846264;","float cosAngle;","float sinAngle;","float offset = PI * 2.0 / circleSamplingTimes * random(vec3(12.9898, 78.233, 151.7182), 0.0);","float stepX = blurX * px.x / linearSamplingTimes;","float stepY = blurY * px.y / linearSamplingTimes;","for (float a = 0.0; a <= PI * 2.0; a += PI * 2.0 / circleSamplingTimes) {","cosAngle = cos(a + offset);","sinAngle = sin(a + offset);","for (float i = 1.0; i <= linearSamplingTimes; i++) {","curDistanceX = i * stepX * cosAngle;","curDistanceY = i * stepY * sinAngle;","curColor = texture2D(uSampler, vec2(vTextureCoord.x + curDistanceX - offsetX, vTextureCoord.y + curDistanceY + offsetY));","totalAlpha += (linearSamplingTimes - i) * curColor.a;","maxTotalAlpha += (linearSamplingTimes - i);","}","}","ownColor.a = max(ownColor.a, 0.0001);","ownColor.rgb = ownColor.rgb / ownColor.a;","float outerGlowAlpha = (totalAlpha / maxTotalAlpha) * strength * alpha * (1. - inner) * max(min(hideObject, knockout), 1. - ownColor.a);","float innerGlowAlpha = ((maxTotalAlpha - totalAlpha) / maxTotalAlpha) * strength * alpha * inner * ownColor.a;","ownColor.a = max(ownColor.a * knockout * (1. - hideObject), 0.0001);","vec3 mix1 = mix(ownColor.rgb, color.rgb, innerGlowAlpha / (innerGlowAlpha + ownColor.a));","vec3 mix2 = mix(mix1, color.rgb, outerGlowAlpha / (innerGlowAlpha + ownColor.a + outerGlowAlpha));","float resultAlpha = min(ownColor.a + outerGlowAlpha + innerGlowAlpha, 1.);","gl_FragColor = vec4(mix2 * resultAlpha, resultAlpha);","}"].join("\n"),e.uniforms={projectionVector:{type:"2f",value:{x:0,y:0},dirty:!0},dist:{type:"1f",value:15,dirty:!0},angle:{type:"1f",value:1,dirty:!0},color:{type:"4f",value:{x:1,y:0,z:0,w:0},dirty:!0},alpha:{type:"1f",value:1,dirty:!0},blurX:{type:"1f",value:1,dirty:!0},blurY:{type:"1f",value:1,dirty:!0},strength:{type:"1f",value:1,dirty:!0},inner:{type:"1f",value:1,dirty:!0},knockout:{type:"1f",value:1,dirty:!0},hideObject:{type:"1f",value:0,dirty:!0},uTextureSize:{type:"2f",value:{x:100,y:100},dirty:!0}},e}return __extends(e,t),e.prototype.setDistance=function(t){var e=this.uniforms.dist;e.value!=t&&(e.value=t,e.dirty=!0)},e.prototype.setAngle=function(t){var e=this.uniforms.angle;e.value!=t&&(e.value=t,e.dirty=!0)},e.prototype.setColor=function(t,e,r){var i=this.uniforms.color;(i.value.x!=t||i.value.y!=e||i.value.z!=r)&&(i.value.x=t,i.value.y=e,i.value.z=r,i.dirty=!0)},e.prototype.setAlpha=function(t){var e=this.uniforms.alpha;e.value!=t&&(e.value=t,e.dirty=!0)},e.prototype.setBlurX=function(t){var e=this.uniforms.blurX;e.value!=t&&(e.value=t,e.dirty=!0)},e.prototype.setBlurY=function(t){var e=this.uniforms.blurY;e.value!=t&&(e.value=t,e.dirty=!0)},e.prototype.setStrength=function(t){var e=this.uniforms.strength;e.value!=t&&(e.value=t,e.dirty=!0)},e.prototype.setInner=function(t){var e=this.uniforms.inner;e.value!=t&&(e.value=t,e.dirty=!0)},e.prototype.setKnockout=function(t){var e=this.uniforms.knockout;e.value!=t&&(e.value=t,e.dirty=!0)},e.prototype.setHideObject=function(t){var e=this.uniforms.hideObject;e.value!=t&&(e.value=t,e.dirty=!0)},e.prototype.setTextureSize=function(t,e){var r=this.uniforms.uTextureSize;(t!=r.value.x||e!=r.value.y)&&(r.value.x=t,r.value.y=e,r.dirty=!0)},e}(t.TextureShader);t.GlowShader=e,__reflect(e.prototype,"egret.native2.GlowShader")}(e=t.native2||(t.native2={}))}(egret||(egret={}));var egret;!function(t){var e;!function(t){var e=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.fragmentSrc="precision lowp float;\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nvoid main(void) {\ngl_FragColor = vColor;\n}",e}return __extends(e,t),e}(t.EgretShader);t.PrimitiveShader=e,__reflect(e.prototype,"egret.native2.PrimitiveShader")}(e=t.native2||(t.native2={}))}(egret||(egret={}));var egret;!function(t){var e;!function(e){var r=function(e){function r(r){var i=e.call(this)||this;return egret_native.pauseApp=function(){r.dispatchEvent(new t.Event(t.Event.DEACTIVATE))},egret_native.resumeApp=function(){r.dispatchEvent(new t.Event(t.Event.ACTIVATE))},i}return __extends(r,e),r}(t.HashObject);e.NativeHideHandler=r,__reflect(r.prototype,"egret.native2.NativeHideHandler")}(e=t.native2||(t.native2={}))}(egret||(egret={}));var egret;!function(t){var e;!function(t){var e=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.fragmentSrc="precision lowp float;\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nuniform sampler2D uSampler;\nuniform vec4 uTextColor;\nuniform vec4 uStrokeColor;\nvoid main(void) {\n   vec4 sample = texture2D(uSampler, vTextureCoord);\n   float fontAlpha = sample.a;\n   float outlineAlpha = sample.r;\n   if (fontAlpha + outlineAlpha > 0.0){\n       vec4 color = uTextColor * fontAlpha + uStrokeColor * outlineAlpha;\n       gl_FragColor = vColor * vec4(color.rgb, max(fontAlpha, outlineAlpha));\n   }\n   else {       discard;   }}\n",e.uniforms={projectionVector:{type:"2f",value:{x:0,y:0},dirty:!0},uTextColor:{type:"4f",value:{x:0,y:0,z:0,w:0},dirty:!0},uStrokeColor:{type:"4f",value:{x:0,y:0,z:0,w:0},dirty:!0}},e}return __extends(e,t),e.prototype.setTextColor=function(t,e,r,i){var a=this.uniforms.uTextColor;(t!=a.value.x||e!=a.value.y||r!=a.value.z||i!=a.value.w)&&(a.value.x=t,a.value.y=e,a.value.z=r,a.value.w=i,a.dirty=!0)},e.prototype.setStrokeColor=function(t,e,r,i){var a=this.uniforms.uStrokeColor;(t!=a.value.x||e!=a.value.y||r!=a.value.z||i!=a.value.w)&&(a.value.x=t,a.value.y=e,a.value.z=r,a.value.w=i,a.dirty=!0)},e}(t.EgretShader);t.FontShader=e,__reflect(e.prototype,"egret.native2.FontShader")}(e=t.native2||(t.native2={}))}(egret||(egret={}));
